<<<<<<< HEAD
"use strict";function dataGridController(w,n,g,e,a,r,l,t,d,i,s,C,c){var p=e.search().query,u=e.search();w.getQuery=u;var m,o={},v=r.navigator.userAgent,h=!0,f=g.ColumnsChooser||["Doc ID","Ver #","Modified","Categories","Updated","Size"];w.dwnIco,w.dwnTxt,w.openTypeSelected={},w.openTypeVerList={};var D,x,I=!!document.documentMode;if(w.showComments=!0,null!=g.showComments&&(w.showComments=g.showComments),w.selectedFile="",C.host=g.host,w.listFailed=!1,w.tableLoader=!0,w.queryTitle=p,w.softpopFlag=1,w.checked=!1,C.tabTypeFlag=!0,w.sortType=1,w.sortFlag=!1,w.columnID="5375",w.shareMenu=[],w.loadingVisible=!1,w.attach=!1,w.gridMessage="",w.showVersion=!1,w.showComment=!0,w.showDocID=!1,w.showModified=!1,w.sortColumn="asc",w.showCheckout=!0,w.showWorkFlow=!0,w.ttl_dsc=" ",w.setIconWidth,w.showPagination=!0,C.parentColumnChoose="#btnColumnChooser",w.deleteValue="",w.showSize=!1,w.showCreated=!1,w.showAccessed=!1,w.showName=!1,w.markModified=!1,w.markSize=!1,w.markCreated=!1,w.markVersion=!1,w.markAccessed=!1,w.markDocId=!1,w.maxWidthDesc=800,w.categoryMenu=[],w.showPageSize=!1,w.pageSize=50,w.$on("openReadOnly",function(e){w.getResponse(w.saveReadOnlyData.fileData,w.saveReadOnlyData.resData,w.saveReadOnlyData.folderData)}),w.$on("setWDGridLoader",function(e){w.tableLoader=!0}),w.$on("updateDataGrid",function(e,t){$("#gridContainer").dxDataGrid("instance").getSelectedRowsData()[0].I="0"}),w.$on("fileAction",function(e,t){var i=$("#gridContainer").dxDataGrid("instance"),o=i.getSelectedRowsData();switch(t.type){case"download":w.download(i.getSelectedRowsData()[0]);break;case"checkOut":y(t.data);break;case"editProfile":l.getDataGridControlerScope(t.data);for(var n={row:{data:i.getSelectedRowsData().pop()}},a=1;a<=7;a++)""!=n.row.data["Field"+a]?(w.fieldContainer["Field"+a]=!0,w.editFields["placeholder"+a]=n.row.data["Field"+a+"Name"],w.editFields["field"+a]=n.row.data["Field"+a]):w.fieldContainer["Field"+a]=!1;s.setSelected(i.getSelectedRowsData()),w.$parent.selectedTab="Profile",C.$broadcast("editIcon",{flag:t.profile}),$("#tabPanelItems").dxTabPanel("instance").option("selectedIndex",0),console.log(n.row.data),w.toggle(n.row.data,!0),w.$parent.checked=!0;break;case"eMail":l.getDataGridControlerScope(t.data),n={row:{data:i.getSelectedRowsData().pop()}};s.setSelected(i.getSelectedRowsData()),$("#tabPanelItems").dxTabPanel("instance").option("selectedIndex",1),w.toggle(n.row.data,!0),w.$parent.dialogTitle=t.profile,w.$parent.checked=!0,"54"==i.getSelectedRowsData()[0].I?$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!0:$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!1;break;case"view":n={row:{data:o.pop()}},l.getDataGridControlerScope(t.data);w.$parent.wdView=!0,$("#gridContainer").css("max-width","none").css("width",""),T(w.gridData.component,w.gridData.component.getSelectedRowsData().pop(),w.gridData),setTimeout(function(){$("#listTitle").css({"max-width":"0px",width:"0px"}),i._windowResizeCallBack(),C.setTitleHeaderWidth()},-1);break;case"reFresh":w.tableLoader=!0,i.refresh()}}),w.$on("fileActionOpen",function(e,t){if(t.listId)return w.setVersion(t.data),!1;w.chkDwnLoadType(t)}),w.wdFilterBox={placeholder:"Filter",elementAttr:{class:"wdFilterBox",id:"wdFilterBox"},onEnterKey:function(e){w.filterGrid(e.event.target.value)},showClearButton:!0},w.wdFilterBtn={icon:"ms-Icon ms-Icon--Accept",onClick:function(e){var t=$("#wdFilterBox").dxTextBox("instance").option("value");w.filterGrid(t)},elementAttr:{class:"wdFilterBtn"}},w.filterGrid=function(e){$("#gridContainer").dxDataGrid("instance").searchByText(e)},w.chkDwnLoadType=function(e){if(u.attach&&e.attType)return w.$parent.changeDialogOption=!1;w.download(e.data)},w.commentLineNumber="",w.fontUnderline="unset",w.fontItalic="normal",w.fontStrikeout=0,w.fontColor="#333",w.fontPaddingl=0,w.fontPaddingr=0,w.fontPaddingt=0,w.fontPaddingb=0,w.fontSectionLabel="Hide Comments",0==w.showComments&&(w.fontSectionLabel="Display Comments"),w.fontName="Calibri",w.fontId=0,w.fontPointsize=14,w.fontWeight=400,w.fontHeight=20,w.fontStyle=[],w.setFontData=function(){n.get(g.host+"cgi-bin/wdwebcgi.exe?FONTGET+wd_SID="+g.userData.session+"+html=/api/font/getfonts.json+wduser="+g.userData.username.split("@")[0]+"+wdIdUn="+Date.now()).then(function(e){if(w.setCss(e.data.root.items),w.commentLineNumber=parseInt(e.data.root.Extra.MaxCommentLines),-1!=navigator.userAgent.indexOf("Firefox")&&(w.commentLineNumber+=parseInt(1)),e.data.root){w.fontStyle=e.data.root.items.map(function(e){return e}),w.fontStyle=angular.fromJson(w.fontStyle);for(var t=0;t<w.fontStyle.length;t++){var i=w.fontStyle[t].crTEXT;i<0&&(i=4294967295+i+1),w.fontStyle[t].crTEXT=i.toString(16).toUpperCase(),1==w.fontStyle[t].bITALIC?w.fontStyle[t].bITALIC="italic":w.fontStyle[t].bITALIC="normal",1==w.fontStyle[t].bUNDERLINE||1==w.fontStyle[t].bSTRIKEOUT?1==w.fontStyle[t].bUNDERLINE?w.fontStyle[t].bUNDERLINE="underline":w.fontStyle[t].bUNDERLINE="line-through":w.fontStyle[t].bUNDERLINE="unset";screen.height;w.fontStyle[t].uHEIGHT="1.1em"}}},function(e){return DevExpress.ui.notify("Server error time out!","error",4e3),a.reject("Data Loading Error")})},w.propertyLineSetting=[],n.get(g.host+"cgi-bin/wdwebcgi.exe?SERVE+wd_SID="+g.userData.session+"+html=/api/ini/iniRead.json+szSection=List%20View+szINI=1+szKey=PropLineProfIDs+wduser="+g.userData.username.split("@")[0]+"+wdIdUn="+Date.now()).then(function(e){if(e.data.root){var t=e.data.root.PropLineProfIDs;w.propertyLineSetting=t.split(",");for(var i=0;i<w.propertyLineSetting.length;i++)switch(w.propertyLineSetting[i]){case"4":w.showModified=!0,w.markModified=!0;break;case"6":w.showSize=!0,w.markSize=!0;break;case"9":w.showCreated=!0,w.markCreated=!0;break;case"20":w.showVersion=!0,w.markVersion=!0;break;case"23":w.showAccessed=!0,w.markAccessed=!0;break;case"2":w.showDocID=!0,w.markDocId=!0}for(i=0;i<f.length;i++)"Comments"==f[i]&&(w.showComments=!1),"Ver #"==f[i]&&(w.showVersion=!1),"Modified"==f[i]&&(w.showModified=!1),"Doc ID"==f[i]&&(w.showDocID=!1),"Size"==f[i]&&(w.showSize=!1),"Created"==f[i]&&(w.showCreated=!1),"Accessed"==f[i]&&(w.showAccessed=!1)}},function(e){return DevExpress.ui.notify("Server error time out!","error",4e3),a.reject("Data Loading Error")}),w.multiple=!1,w.accept="*",w.value=[],w.uploadMode="instantly",w.selectedText="",w.widthDes="75%",$(window).width()<=1024&&(w.widthDes="30%"),w.widthFit="240",$(window).width()<=414&&(w.widthFit=295),$(window).width()<=375&&(w.widthFit=255),$(window).width()<=360&&(w.widthFit=240),$(window).width()<=320&&(w.widthFit=200),g.ColumnsChooser){for(var _=g.ColumnsWidths,S=g.ColumnsChooser,b=0;b<_.length;b++)switch(S[b]){case"Ver #":w.widthVer=_[b];break;case"Doc ID":w.widthDocID=_[b];break;case"Categories":w.widthCategories=_[b];break;case"Created":w.widthCreated=_[b];break;case"Accessed":w.widthAccessed=_[b];break;case"Updated":case"Modified":w.widthUpdated=_[b];break;case"Size":w.widthSize=_[b];break;case"Cabinet":w.widthCabinet=_[b];break;case"Location":w.widthLocation=_[b]}w.widthDes=g.DescriptionWidth}else w.widthVer=70,w.widthDocID=120,w.widthCategories=180,w.widthCreated=180,w.widthAccessed=180,w.widthModified=180,w.widthUpdated=180,w.widthSize=80,w.widthCabinet=100,w.widthLocation=200;w.setCss=function(e){var t=".lineOne { font-size: "+e[10].uPOINTSIZE+"pt; font-style: "+("0"!==e[10].bITALIC?"italic":"normal")+"; text-decoration: "+("0"!==e[10].bUNDERLINE?"underline":"none")+"; color: "+e[10].crTEXT+"; font-family: "+e[10].szFACENAME+"; font-weight: "+e[10].uWEIGHT+" }",i=".chkLabel { font-size: "+e[7].uPOINTSIZE+"pt; font-family: "+e[7].szFACENAME+"; font-style: "+("0"!==e[7].bITALIC?"italic":"normal")+"; color: "+e[7].crTEXT+"; font-weight: "+e[7].uWEIGHT+" }",o=".chkName { font-style: "+("0"!==e[6].bITALIC?"italic":"normal")+"; text-decoration: "+("0"!==e[6].bUNDERLINE?"underline":"none")+"; color: "+e[6].crTEXT+"; font-family: "+e[6].szFACENAME+"; font-weight: "+e[6].uWEIGHT+"; line-height: "+e[6].uHEIGHT+"; font-size: "+e[6].uPOINTSIZE+"pt; }",n=".chkLink { font-size: "+e[7].uPOINTSIZE+"pt }",a=".chkPadding { padding-top: "+e[7]["RC.TOP"]+"px; padding-bottom: "+e[7]["RC.BOTTOM"]+"px;}",l=".commLine { font-size: "+e[1].uPOINTSIZE+"pt; line-height: "+-1*e[1].uHEIGHT+"px !important; overflow: hidden; position: relative; font-style: "+("0"!==e[1].bITALIC?"italic":"normal")+"; text-decoration: "+("0"!==e[1].bUNDERLINE?"underline":"none")+"; color: "+e[1].crTEXT+"; font-family: "+e[1].szFACENAME+"; font-weight: "+e[1].uWEIGHT+"; }",r=".commPadding { padding: "+e[1]["RC.TOP"]+"px "+e[1]["RC.RIGHT"]+"px "+e[1]["RC.BOTTOM"]+"px "+e[1]["RC.LEFT"]+"px }",d=".propLabel { font-size: "+e[9].uPOINTSIZE+"pt; text-decoration: "+("0"!==e[9].bUNDERLINE?"underline":"none")+"; color: "+e[9].crTEXT+"; font-family: "+e[9].szFACENAME+"; font-weight: "+e[9].uWEIGHT+"; line-height: "+e[9].uHEIGHT+"; font-style: "+("0"!==e[9].bITALIC?"italic":"normal")+";}",s=".propValue { font-size: "+e[8].uPOINTSIZE+"pt; text-decoration: "+("0"!==e[8].bUNDERLINE?"underline":"none")+"; color: "+e[8].crTEXT+"; font-family: "+e[8].szFACENAME+"; font-weight: "+e[8].uWEIGHT+"; line-height: "+e[8].uHEIGHT+"; font-style: "+("0"!==e[8].bITALIC?"italic":"normal")+";} ",c=".propTopPadding { padding-top: "+e[9]["RC.TOP"]+"px; }",p=".propPadding { padding: "+e[9]["RC.TOP"]+"px "+e[9]["RC.RIGHT"]+"px "+e[9]["RC.BOTTOM"]+"px "+e[9]["RC.LEFT"]+"px }",u=t+i+o+n+l+r+d+s+p+c+a+p,m=document.createElement("style");m.type="text/css",m.innerHTML=u,document.body.appendChild(m)},w.gridShading=!0,w.wdGridLoader={shading:"gridShading",shadingColor:"rgba(256,256,256,0.9)",position:{of:"#gridContainer .dx-datagrid-rowsview "},bindingOptions:{visible:"tableLoader"},elementAttr:{class:"gridLoader"}},w.items={},C.temp_description="Description",C.temp_docid="Doc ID",C.temp_version="Ver#",C.temp_modified="Modified",C.temp_comment="Comments",C.temp_descrcomment="",C.temp_created="Created",C.temp_accessed="Accessed",C.temp_size="Size",C.temp_cabinet="Cabinet",C.temp_location="Location",C.temp_categories="Categories",C.temp_checkoutLabel=0,C.temp_checkoutValue=0,C.temp_name="Name",C.temp_status=0,C.lastVersionFile=0,C.versionlist=!1;var F=new DevExpress.data.CustomStore({key:["DocId","Version"],load:function(e){var t={},i="",o="";switch(w.sortFlag){case!1:u.typeid?"template"==u.typeid?(w.queryTitle="Template: "+u.temp,i="+wd_File_Xname_Filter="+u.xName+"+wd_File_Filename_Filter="+u.fName+"+wd_File_AccessDate_Filter="+u.access+"+wd_File_Created_Filter="+u.create+"+wd_File_Updated_Filter="+u.modified+"+wd_File_Text_Filter="+u.text+"+wd_File_ProfileGroup_Filter="+u.cabinet+"+wd_File_Field1_Filter="+u.field1+"+wd_File_Field2_Filter="+u.field2+"+wd_File_Field3_Filter="+u.field3+"+wd_File_Field4_Filter="+u.field4+"+wd_File_Field5_Filter="+u.field5+"+wd_File_Field6_Filter="+u.field6+"+wd_File_Field7_Filter="+u.field7,o="FINDFILES",C.versionlist=!1):"version"==u.typeid?(i="+wd_List_ID="+u.verid+"+Wd_List_RecNum="+u.verRec+"+Wd_File_Sort_Key1="+g.columnId.version,o="VERLIST",C.versionlist=!0):(i="+wd_List_RecNum="+u.recId+"+wd_List_ID="+u.listId+"+wd_List_Flags="+u.flagId+"+typeid="+u.typeid,o="TREEOPEN",C.versionlist=!1):(i="+wd_FIND_QUERY="+p,o="FINDFILES",C.versionlist=!1);break;default:o="SORTFILES",i="+wd_List_ID="+g.wdListID}e.sort&&(t.orderby=e.sort[0].selector,e.sort[0].desc&&(t.orderby+=" desc")),e.skip?t.skip=parseInt(e.skip)+1||0:t.skip=0,t.take=e.take||50;return n.get(g.host+"cgi-bin/wdwebcgi.exe?"+o+"+wd_SID="+g.userData.session+"+html=/api/filelist/fileList.json"+i+"+skip="+t.skip+"+take="+t.take+"+Wd_File_Sort_Key1="+w.columnID+"+wd_File_Sort_Dir1="+w.sortType+"+wduser="+g.userData.username.split("@")[0]+"+wdIdUn="+Date.now()).then(function(e){if(C.title=e.data.root.Header.wd_Desc_Loc,w.listCount=e.data.root.Header.List_Count,-1!=v.indexOf("Frowser")?C.pageTitle=e.data.root.Header.wd_Tab:C.pageTitle=e.data.root.Header.wd_Tab.split(":")[1],""!=e.data.root.Header.ErrorCount&&"1"==e.data.root.Header.List_Count){if(1!=e.data.root.items.length||-1==e.data.root.items[0].Description.indexOf("Too many files found ("))return w.listFailed=!0,w.gridMessage=e.data.root.Header.wd_Error_MSG,{data:[],totalCount:0};w.gridMessage=e.data.root.items[0].Description;var t=w.gridMessage.split(".")[0];return w.getDefaultTemplate(!1),w.$parent.templates=!0,DevExpress.ui.notify(t+" , please narrow down your search.","error",4e3),{data:[],totalCount:0}}if(""!=e.data.root.Header.ErrorCount&&"0"==e.data.root.Header.List_Count)return w.listFailed=!0,w.gridMessage="No data found!",{data:[],totalCount:0};if(""==e.data.root.items)return w.gridMessage="No data found!",{data:[],totalCount:e.data.root.Header.List_Count};var i=e.data.root.Header.wd_Groupings;if(g.wdListID=e.data.root.Header.List_ID,w.callFlag){switch(i){case"1":var o=$("#gridContainer").dxDataGrid("instance"),n=o.option("columns");n.push({dataField:"GT"}),o.option("columns",n),o.columnOption("GT","groupIndex",0)}w.callFlag=!1}for(var a=e.data.root.items.map(function(e){return e}),l=0;l<a.length;l++){if(C.lastVersionFile<a[l].Version&&(C.lastVersionFile=a[l].Version),""==a[l].AccessedDate)a[l].Accessed="";else{var r=new Date(parseInt(1e3*a[l].AccessedDate));a[l].Accessed=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()}if(""==a[l].DateCreated)a[l].Created="";else{r=new Date(parseInt(1e3*a[l].DateCreated));a[l].Created=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()}if(C.temp_description.length<String(a[l].Description).length&&(C.temp_description=String(a[l].Description)),C.temp_docid.length<String(a[l].DocId).length&&(C.temp_docid=String(a[l].DocId)),a[l].Version&&C.temp_version.length<String(a[l].Version).length&&(C.temp_version=String(a[l].Version)),a[l].Comments){var d;d=a[l].Comments.split("\r\n");for(var s=0;s<d.length;s++)C.temp_descrcomment.length<String(d[s]).length&&(C.temp_descrcomment=d[s]);a[l].firstLineComments=d[0],C.temp_comment.length<d[0].length&&(C.temp_comment=String(d[0]))}if(C.temp_size.length<String(a[l].Size).length&&(C.temp_size=String(a[l].Size)),C.temp_cabinet.length<String(a[l].Cabinet).length&&(C.temp_cabinet=String(a[l].Cabinet)),C.temp_location.length<String(a[l].Location).length&&(C.temp_location=String(a[l].Location)),C.temp_name.length<String(a[l].Name).length&&(C.temp_name=String(a[l].Name)),a[l].CAT_ID){for(var c="",p=0;p<a[l].CAT_ID.length;p++)c+=", "+String(a[l].CAT_ID[p].CD);C.temp_categories.length<c.length&&(C.temp_categories=c)}if(49==a[l].I||48==a[l].I){w.canvas_checkoutLabel=angular.element("#myCanvas_checkoutLabel"),w.ctx_checkoutLabel=w.canvas_checkoutLabel[0].getContext("2d"),void 0===w.fontStyle[7]?w.ctx_checkoutLabel.font="9pt Calibri":w.ctx_checkoutLabel.font=w.fontStyle[7].uPOINTSIZE+"pt "+w.fontStyle[7].szFACENAME;var u=String(a[l].CHKOUT_TO_PREF)+String(a[l].CHKOUT_ON_PREF);48==a[l].I&&(u+="Check-In    ");var m=w.ctx_checkoutLabel.measureText(u).width;m>C.temp_checkoutLabel&&(C.temp_checkoutLabel=m),w.canvas_checkoutValue=angular.element("#myCanvas_checkotuValue"),w.ctx_checkoutValue=w.canvas_checkoutValue[0].getContext("2d"),void 0===w.fontStyle[6]?w.ctx_checkoutValue.font="10pt Calibri":w.ctx_checkoutValue.font=w.fontStyle[6].uPOINTSIZE+"pt "+w.fontStyle[6].szFACENAME;var h=String(a[l].CHKOUT_TO_NAME)+String(a[l].CHKOUT_ON_DATE),f=w.ctx_checkoutValue.measureText(h).width;f>C.temp_checkoutValue&&(C.temp_checkoutValue=f)}49!=a[l].I&&48!=a[l].I&&0!=a[l].I&&"undefined"!=a[l].I&&(C.temp_status=1)}return w.items=a,w.selectedText="File: "+w.items[0].LN+"/"+w.listCount,-1==v.indexOf("Frowser")&&void 0!==g.currentFile&&(g.currentFile.LID=e.data.root.Header.List_ID,w.loadPreviewWhenStartup(a)),{data:a,totalCount:e.data.root.Header.List_Count}},function(e){return DevExpress.ui.notify("Server error time out!","error",4e3),a.reject("Data Loading Error")})}});function T(e,t,i){o={LN:t.LN,RN:t.RN,LID:t.LID,Status:t.I,DocId:t.DocId,tags:t.CAT_ID,Description:t.Description},"group"!==i.rowType&&w.$parent.wdView&&(w.$parent.dialogTitle="Preview",w.$parent.listOptions=[t],w.filePage(o))}function y(e){var t=$("#gridContainer").dxDataGrid("instance").getSelectedRowsData();w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],w.$parent.dialogTitle="Check-Out";for(var i=0;i<t.length;i++)w.checkOutput(t[i])}w.rowSetCate="",w.contextualMenu=function(n){if(w.rowSetCate=n,w.cat={publicCat:[],personalCat:[],folderCat:[]},w.selectedFile=n.row.data.LN,w.selectedText="File: "+w.selectedFile+"/"+w.listCount,"headerPanel"!==n.target&&"data"===n.row.rowType&&"Categories"!==n.column.caption)n.element="<h1>"+n.row.data.Description+"</h1>",n.items=l.getContextMenu(n);else if("headerPanel"!==n.target&&"data"===n.row.rowType&&"Categories"==n.column.caption){if(console.log("blahs"),n.component.selectRows(n.row.key,!1),w.noDub=[],w.catResponse="",w.shareMenu=[{text:"Add Category",icon:"ms-Icon ms-Icon--Add",items:w.subAddCategory,onItemClick:function(e){console.log(e.component)}},{text:"Create/Edit Categories",icon:"ms-Icon ms-Icon--SaveAs",onItemClick:function(e){C.$broadcast("categoryList",{cats:w.catResponse,file:n.row.data,type:"dataGrid"}),w.$parent.openCats=!0}}],w.categoryMenu=w.shareMenu,l.getCategoryList(n.row.data.FilePath).then(function(e){w.catResponse=e.data.root,w.showCatType={};var o=[];if(""!==w.catResponse.Header.Error_Count)return DevExpress.ui.notify(w.catResponse.Header.Error_Msg,"error",4e3),!1;angular.forEach(w.catResponse.Items,function(t,e){switch(o.push(t.TAB_NAME),t.TAB_NAME){case"Public":var i={text:t.CD,icon:C.host+t.CI,onItemClick:function(e){w.setCategory(t,n,!1)}};w.cat.publicCat.push(i);break;case"Personal":i={text:t.CD,icon:C.host+t.CI,onItemClick:function(e){w.setCategory(t,n,!1)}};w.cat.personalCat.push(i);break;case"Folder":i={text:t.CD,icon:C.host+t.CI,onItemClick:function(e){w.setCategory(t,n,!1)}};w.cat.folderCat.push(i)}});var t=o.filter(function(e,t){return o.indexOf(e)==t});angular.forEach(t,function(e,t){w.setSubMenu=[],"Public"==e?w.setSubMenu=w.cat.publicCat:"Personal"==e&&(w.setSubMenu=w.cat.personalCat),"Folder"==e&&(w.setSubMenu=w.cat.folderCat),w.noDubKey={},w.noDubKey={text:e,items:w.setSubMenu},w.noDub.push(w.noDubKey)}),angular.forEach(n.items,function(e,t){"Add Category"==e.text&&(w.subAddCategory=w.noDub)})},function(e){}),""==n.row.data.CAT_ID)w.categoryMenu=w.shareMenu;else{w.categorylist=[];var i={};angular.forEach(n.row.data.CAT_ID,function(t,e){i={text:t.CD,icon:C.host+t.CI,items:[{text:"Remove",icon:"ms-Icon ms-Icon--Remove",onItemClick:function(e){w.setCategory(t,n,!0)}}]},w.categorylist.push(i)}),w.categoryMenu=w.categorylist.concat(w.shareMenu)}n.items=w.categoryMenu}},w.dataGridOptions={useKeyboard:!I,dataSource:{store:F},bindingOptions:{rowAlternationEnabled:!0,"pager.infoText":"selectedText","pager.showPageSizeSelector":"showPageSize","paging.pageSize":"pageSize"},allowColumnReordering:!0,columnChooser:{},scrolling:{showScrollbar:"always",useNative:!0,renderingThreshold:1e4},renderAsync:!0,columnFixing:{enabled:!0},columnAutoWidth:!0,selection:{mode:"single",selectAllMode:"page"},remoteOperations:{sorting:!0,paging:!0},pager:{allowedPageSizes:[50,100,150,200,250],showInfo:!0,visible:!0,showNavigationButtons:!1},showColumnLines:!1,showRowLines:!0,rowAlternationEnabled:!1,showBorders:!0,hoverStateEnabled:!0,tabIndex:-1,allowColumnResizing:!0,calculateFilterExpression:function(e){console.log(e)},onInitialized:function(e){w.setFontData()},columns:[{dataField:"",cellTemplate:"downLoadFile",showInColumnChooser:!1,width:"22",allowSorting:!1,allowSearch:!0},{caption:"",dataField:"TypeStatus",cellTemplate:"fileSecurityIco",showInColumnChooser:!1,width:"25",name:"ico",allowSorting:!1,allowSearch:!0},{caption:"Description",dataField:"Description",cellTemplate:"cellTemplate",showInColumnChooser:!1,calculateCellValue:function(e){if(""!=e.DateUpdated){var t=new Date(parseInt(1e3*e.DateUpdated)),i=t.getHours(),o=t.getMinutes(),n=12<=i?"PM":"AM";i=(i%=12)||12,o=o<10?"0"+o:o,e.Modified=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+"  "+i+":"+o+" "+n}if(""!=e.Description)return e.Description;return"Blank Description"},filterOperations:[],selectedFilterOperation:"contains",allowFiltering:!0,minWidth:"80",width:w.widthDes,allowSearch:!0},{caption:"Doc ID",dataField:"DocId",filterOperations:[],selectedFilterOperation:"contains",minWidth:"60",width:w.widthDocID,calculateCellValue:function(e){return e.DocId},visible:-1<f.indexOf("Doc ID"),cellTemplate:function(e,t){e.append("<div class='topPadding'><div style='overflow: hidden; white-space: nowrap; text-overflow: ellipsis;' class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{dataField:"Ver#",calculateCellValue:function(e){return e.Version},cellTemplate:"versionCell",filterOperations:[],selectedFilterOperation:"contains",minWidth:"50",width:w.widthVer,visible:-1<f.indexOf("Ver #"),allowSearch:!0},{caption:"Modified",dataField:"DateUpdated",filterOperations:[],selectedFilterOperation:"contains",sortOrder:"desc",calculateCellValue:function(e){if(""==e.DateUpdated)return null;var t=new Date(parseInt(1e3*e.DateUpdated)),i=t.getHours(),o=t.getMinutes(),n=12<=i?"PM":"AM";return i=(i%=12)||12,o=o<10?"0"+o:o,t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+"  "+i+":"+o+" "+n},minWidth:"70",width:w.widthModified,visible:-1<f.indexOf("Modified"),cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis;\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Comments",dataField:"comment",calculateCellValue:function(e){var t=e.firstLineComments;return t||""},filterOperations:[],selectedFilterOperation:"contains",minWidth:"70",width:w.widthDocID,visible:-1<f.indexOf("Comments"),cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis;\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Categories",dataField:"CD",cellTemplate:"wdTags",filterOperations:[],selectedFilterOperation:"contains",allowFiltering:!0,minWidth:"75",width:w.widthCategories,visible:-1<f.indexOf("Categories"),allowSearch:!0},{caption:"Created",dataField:"DateCreated",filterOperations:[],selectedFilterOperation:"contains",calculateCellValue:function(e){if(""==e.DateCreated)return null;var t=new Date(parseInt(1e3*e.DateCreated));return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},visible:-1<f.indexOf("Created"),minWidth:"70",width:w.widthCreated,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Accessed",dataField:"AccessedDate",filterOperations:[],selectedFilterOperation:"contains",calculateCellValue:function(e){if(""==e.AccessedDate)return null;var t=new Date(parseInt(1e3*e.AccessedDate));return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},visible:-1<f.indexOf("Accessed"),minWidth:"70",width:w.widthAccessed,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{dataField:"Size",filterOperations:[],selectedFilterOperation:"contains",minWidth:"50",calculateCellValue:function(e){return e.Size},width:w.widthSize,visible:-1<f.indexOf("Size"),cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{filterOperations:[],selectedFilterOperation:"contains",dataField:"Cabinet",calculateCellValue:function(e){return e.Cabinet},visible:-1<f.indexOf("Cabinet"),minWidth:"60",width:w.widthCabinet,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{filterOperations:[],selectedFilterOperation:"contains",dataField:"Location",calculateCellValue:function(e){return e.Location},visible:-1<f.indexOf("Location"),minWidth:"60",width:w.widthLocation,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 1 Desc",dataField:"Field1Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 1 Desc"),headerCellTemplate:"Field1 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 1 Code",dataField:"Field1",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 1 Code"),headerCellTemplate:"Field1 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 2 Desc",dataField:"Field2Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 2 Desc"),headerCellTemplate:"Field2 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 2 Code",dataField:"Field2",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 2 Code"),headerCellTemplate:"Field2 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 3 Desc",dataField:"Field3Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 3 Desc"),headerCellTemplate:"Field3 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 3 Code",dataField:"Field3",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 3 Code"),headerCellTemplate:"Field3 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 4 Desc",dataField:"Field4Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 4 Desc"),headerCellTemplate:"Field4 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 4 Code",dataField:"Field4",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 4 Code"),headerCellTemplate:"Field4 CodeT emplate",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 5 Desc",dataField:"Field5Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 5 Desc"),headerCellTemplate:"Field5 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 5 Code",dataField:"Field5",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 5 Code"),headerCellTemplate:"Field5 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 6 Desc",dataField:"Field6Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 6 Desc"),headerCellTemplate:"Field6 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 6 Code",dataField:"Field6",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 6 Code"),headerCellTemplate:"Field6 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 7 Desc",dataField:"Field7Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 7 Desc"),headerCellTemplate:"Field7 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 7 Code",dataField:"Field7",locateInMenu:"auto",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 7 Code"),headerCellTemplate:"Field7 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0}],onContentReady:function(e){C.setTitleHeaderWidth();e.component.getView("columnChooserView");var t=document.getElementById("overlay");m=$("#gridContainer").dxDataGrid("instance"),$(".dx-freespace-row").css("height",1);var i=e.component;e.component.pageCount()<=1&&(w.showPagination=!1),w.columnarr=[],w.columnarr_item=[],w.columnarr_visivle=[],w.lastcolumn="";for(var o=0;o<i.columnCount();o++){var n=i.columnOption(o);1==n.showInColumnChooser&&(w.columnarr.push([n.caption,n.dataField]),w.columnarr_item.push(n.caption),1==n.visible&&(w.columnarr_visivle.push(n.caption),w.lastcolumn=n.caption))}if(1==C.temp_status?i.columnOption("TypeStatus","width",50):i.columnOption("TypeStatus","width",25),!g.ColumnsChooser){w.canvas=angular.element("#myCanvas"),w.ctx=w.canvas[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx.font="11pt Calibri":w.ctx.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp=C.temp_description;var a=0;a=50+C.temp_checkoutValue+C.temp_checkoutLabel<25+w.ctx.measureText(w.html_temp).width?20+w.ctx.measureText(w.html_temp).width:50+C.temp_checkoutValue+C.temp_checkoutLabel,w.canvas_docid=angular.element("#myCanvas_docid"),w.ctx_docid=w.canvas_docid[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_docid.font="11pt Calibri":w.ctx_docid.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_docid=C.temp_docid,i.columnOption("Doc ID","width",25+w.ctx_docid.measureText(w.html_temp_docid).width),w.widthDocID=25+w.ctx_docid.measureText(w.html_temp_docid).width,w.canvas_version=angular.element("#myCanvas_version"),w.ctx_version=w.canvas_version[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_version.font="11pt Calibri":w.ctx_version.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_version=C.temp_version,i.columnOption("Ver#","width",25+w.ctx_version.measureText(w.html_temp_version).width),w.widthVer=25+w.ctx_version.measureText(w.html_temp_version).width,w.canvas_modified=angular.element("#myCanvas_modified"),w.ctx_modified=w.canvas_modified[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_modified.font="11pt Calibri":w.ctx_modified.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_modified=angular.element(document).find("#myCanvas_modified")[0].innerHTML,i.columnOption("Modified","width",25+w.ctx_modified.measureText(w.html_temp_modified).width),w.widthModified=25+w.ctx_modified.measureText(w.html_temp_modified).width,w.canvas_categories=angular.element("#myCanvas_categories"),w.ctx_categories=w.canvas_categories[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_categories.font="11pt Calibri":w.ctx_categories.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_categories=C.temp_categories,i.columnOption("Categories","width",90+w.ctx_categories.measureText(w.html_temp_categories).width),w.widthCategories=90+w.ctx_categories.measureText(w.html_temp_categories).width,w.canvas_size=angular.element("#myCanvas_size"),w.ctx_size=w.canvas_size[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_size.font="11pt Calibri":w.ctx_size.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_size=C.temp_size,i.columnOption("Size","width",50+w.ctx_size.measureText(w.html_temp_size).width),w.widthSize=50+w.ctx_size.measureText(w.html_temp_size).width,w.canvas_comment=angular.element("#myCanvas_comment"),w.ctx_comment=w.canvas_comment[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_comment.font="11pt Calibri":w.ctx_comment.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_comment=C.temp_comment,i.columnOption("Comments","width",25+w.ctx_comment.measureText(w.html_temp_comment).width),w.ctx_descomment=w.canvas_comment[0].getContext("2d"),void 0===w.fontStyle[1]?w.ctx_descomment.font="12pt Calibri":w.ctx_descomment.font=w.fontStyle[1].uPOINTSIZE+"pt "+w.fontStyle[1].szFACENAME,a<50+w.ctx_descomment.measureText(C.temp_descrcomment).width&&(a=50+w.ctx_descomment.measureText(C.temp_descrcomment).width),w.canvas_propLabel=angular.element("#myCanvas_propLabel"),w.ctx_propLabel=w.canvas_propLabel[0].getContext("2d"),void 0===w.fontStyle[9]?w.ctx_propLabel.font="10pt Calibri":w.ctx_propLabel.font=w.fontStyle[9].uPOINTSIZE+"pt "+w.fontStyle[9].szFACENAME,w.canvas_propValue=angular.element("#myCanvas_propValue"),w.ctx_propValue=w.canvas_propValue[0].getContext("2d"),void 0===w.fontStyle[8]?w.ctx_propValue.font="10pt Calibri":w.ctx_propValue.font=w.fontStyle[8].uPOINTSIZE+"pt "+w.fontStyle[8].szFACENAME;var l="",r="";switch(w.showVersion&&(l+="Version #",r+=C.temp_version),w.showDocID&&(l+="Doc ID: ",r+=C.temp_docid),w.showModified&&(l+="Modified: ",r+=w.html_temp_modified),w.showSize&&(l+="Size: ",r+=C.temp_size),w.showCreated&&(l+="Created: ",r+=angular.element(document).find("#myCanvas_created")[0].innerHTML),w.showAccessed&&(l+="Accessed: ",r+=angular.element(document).find("#myCanvas_created")[0].innerHTML),a<50+w.ctx_propLabel.measureText(l).width+w.ctx_propValue.measureText(r).width&&(a=50+w.ctx_propLabel.measureText(l).width+w.ctx_propValue.measureText(r).width),i.columnOption("Description","width",a),w.canvas_cabinet=angular.element("#myCanvas_cabinet"),w.ctx_cabinet=w.canvas_cabinet[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_cabinet.font="11pt Calibri":w.ctx_cabinet.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_cabinet=C.temp_cabinet,i.columnOption("Cabinet","width",25+w.ctx_cabinet.measureText(w.html_temp_cabinet).width),w.widthCabinet=25+w.ctx_cabinet.measureText(w.html_temp_cabinet).width,w.canvas_location=angular.element("#myCanvas_location"),w.ctx_location=w.canvas_comment[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_location.font="11pt Calibri":w.ctx_location.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_location=C.temp_location,i.columnOption("Location","width",25+w.ctx_location.measureText(w.html_temp_location).width),w.widthLocation=25+w.ctx_location.measureText(w.html_temp_location).width,w.canvas_created=angular.element("#myCanvas_created"),w.ctx_created=w.canvas_created[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_created.font="11pt Calibri":w.ctx_created.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_created=angular.element(document).find("#myCanvas_created")[0].innerHTML,i.columnOption("Created","width",25+w.ctx_created.measureText(w.html_temp_created).width),i.columnOption("Accessed","width",25+w.ctx_created.measureText(w.html_temp_created).width),w.widthCreated=25+w.ctx_created.measureText(w.html_temp_created).width,w.widthAccessed=25+w.ctx_created.measureText(w.html_temp_created).width,w.lastcolumn){case"Doc ID":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_docid.measureText(w.html_temp_docid).width),w.widthDocID="70%";break;case"Ver#":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_version.measureText(w.html_temp_version).width),w.widthVer="70%";break;case"Modified":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_modified.measureText(w.html_temp_modified).width),w.widthModified="70%";break;case"Categories":i.columnOption(w.lastcolumn,"minWidth",50+w.ctx_categories.measureText(w.html_temp_categories).width),w.widthCategories="70%";break;case"Size":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_size.measureText(w.html_temp_size).width),w.widthSize="70%";break;case"Comments":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_comment.measureText(w.html_temp_comment).width);break;case"Cabinet":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_cabinet.measureText(w.html_temp_cabinet).width),w.widthCabinet="70%";break;case"Location":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_location.measureText(w.html_temp_location).width),w.widthLocation="70%";break;case"Created":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_created.measureText(w.html_temp_created).width),w.widthCreated="70%";break;case"Accessed":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_created.measureText(w.html_temp_created).width),w.widthAccessed="70%"}i.columnOption(w.lastcolumn,"width","70%")}if(w.deleteType="toggle",w.scrollBtm="ScrollBottom",w.allowEditing=!1,w.selectedItems=w.columnarr_visivle,w.listOptions_clm_cbx={dataSource:w.columnarr_item.sort(),editEnabled:!0,height:187,showSelectionControls:!0,selectionMode:"multiple",pageLoadMode:"scrollBtm",bindingOptions:{allowItemDeleting:"allowEditing",itemDeleteMode:"deleteType",selectedItems:"selectedItems"}},w.indicateWidth=e.element.width(),w.indicateHeight=e.element.height(),w.gridData=e,!g.isOpeningDocPanel&&0<e.component.totalCount()&&-1==w.gridMessage.indexOf("Too many files found (")){var d;e.component.selectRowsByIndexes(0),d=e.component.getSelectedRowsData(),w.setToolbarStatus(d[0]),w.loadHeader(d[0])}$(".dx-freespace-row").css("height",1),setTimeout(function(){var e=$("#leftNav").width();$("#gridContainer").css("max-width",parseInt(parseInt($(window).width())-parseInt(e))+"px")},-1),w.listCount>w.pageSize&&(w.showPageSize=!0),$("#gridContainer").mouseover(function(e){C.checkOverGrid=!0}),$("#gridContainer").mouseout(function(e){C.checkOverGrid=!1}),c(function(){t.classList.add("loaded"),w.tableLoader=!1},-1e3)},onRowPrepared:function(e){"data"==e.rowType&&e.rowElement.attr({id:"ln"+e.data.LN})},onToolbarPreparing:function(e){e.toolbarOptions.items.unshift({location:"before",template:"queryTitle"}),e.toolbarOptions.items.unshift({location:"after",template:"wdGridFilter",width:w.widthFit}),e.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"ms-Icon ms-Icon--Settings",text:"",onClick:function(e){w.isPopupVisible=!0},elementAttr:{id:"btnCustomize"}}})},onRowClick:function(e){var t=e.component;t.getSelectedRowKeys().length,t.lastClickTime;o={LN:e.data.LN,RN:e.data.RN,LID:e.data.LID,Status:e.data.I,DocId:e.data.DocId,tags:e.data.CAT_ID,Description:e.data.Description,profileGroupId:e.data.profileGroupId,Extension:e.data.Extension,FilePath:e.data.FilePath,ver:e.data.version},t.lastClickTime=new Date,D&&x===e.rowIndex?(D=null,x=e.rowIndex,void 0!==e.data.Version&&null==u.verid?(w.$parent.dialogTitle=w.dwnTxt,w.$parent.userType="version",w.$parent.errorTypeDialog="user",w.$parent.fileError=!0,w.$parent.wdDocId=e.data.DocId,w.$parent.wdDesc=e.data.Description,w.$parent.changeDialogOption=!0):w.download(o)):(D=!0,setTimeout(function(){D=!1},250),w.selectedFile=e.data.LN,w.selectedText="File: "+w.selectedFile+"/"+w.listCount,w.loadHeader(e.data),T(e.component,e.data,e)),w.setToolbarStatus(e.data),v.indexOf("Frowser"),x=e.rowIndex},onContextMenuPreparing:w.contextualMenu,height:function(){return w.getHeight(!0)},onCellClick:function(e){var t=e.component.getSelectedRowKeys().length;if(w.selectedRow=t,w.selectedFiles=e.component.getSelectedRowsData(),"header"===e.rowType&&void 0!==e.column.dataType){var i;switch(w.sortFlag=!0,e.column.caption){case"Description":i=void 0,w.columnID=g.columnId.desc;break;case"Categories":i=void 0,w.columnID=g.columnId.category;break;case"Ver #":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.version;break;case"Doc ID":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.docid;break;case"Created":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.create;break;case"Updated":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.update;break;case"Accessed":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.access;break;case"Location":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.location;break;case"Size":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.size;break;case"Cabinet":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.cabinet;break;case"Field 1 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field1;break;case"Field 1 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field1Desc;break;case"Field 2 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field2;break;case"Field 2 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field2Desc;break;case"Field 3 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field3;break;case"Field 3 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field3Desc;break;case"Field 4 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field4;break;case"Field 4 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field4Desc;break;case"Field 5 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field4;break;case"Field 5 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field5Desc;break;case"Field 6 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field6;break;case"Field 6 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field6Desc;break;case"Field 7 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field7;break;case"Field 7 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field7Desc;break;case void 0:break;default:console.log("blank")}switch(i){case"dx-sort-none":case"dx-sort-down":w.sortType=0;break;case void 0:h&&(w.sortType=1),h||(w.sortType=0),h=!h;break;default:w.sortType=1}e.component.refresh()}if("boolean"===e.column.dataType){t=e.component.getSelectedRowKeys().length;w.selectedRow=e.component.getSelectedRowKeys().length,T(e.component,e.component.getSelectedRowsData().pop(),e)}},selectedRowKeys:void 0!==g.currentFile?g.currentFile.DocId:[],onKeyDown:function(e){var t=e.component.getSelectedRowKeys();if(t.length){var i=t[0],o=e.component.getRowIndexByKey(i);39!==e.event.keyCode&&37!==e.event.keyCode||e.event.preventDefault(),38===e.event.keyCode?1<e.component.getSelectedRowKeys().length?e.event.preventDefault():0<=--o&&e.component.selectRowsByIndexes([o]):40===e.event.keyCode&&(1<e.component.getSelectedRowKeys().length?e.event.preventDefault():(o++,e.component.getDataSource().items().length===o?o=o:(e.component.selectRowsByIndexes([o]),e.event.stopPropagation()))),!w.$parent.wdView||38!==e.event.keyCode&&40!==e.event.keyCode||T(e.component,e.component.getSelectedRowsData().pop(),e)}},customizeColumns:function(e){for(var t=$("#gridContainer").dxDataGrid("instance"),i=0;i<t.columnCount();i++){t.columnOption(i);g.ColumnsIndex?e[i].visibleIndex=g.ColumnsIndex[i]:e[i].visibleIndex=i}},onColumnsChanging:function(e){var t=$("#gridContainer").dxDataGrid("instance");w.maxWidthDesc<t.columnOption("Description","width")?(t.columnOption("Description","width",w.maxWidthDesc),t.columnOption("Doc ID","width",w.widthDocID),t.columnOption("Ver#","width",w.widthVer),t.columnOption("Modified","width",w.widthModified),t.columnOption("Categories","width",w.widthCategories),t.columnOption("Created","width",w.widthCreated),t.columnOption("Accessed","width",w.widthAccessed),t.columnOption("Size","width",w.widthSize),t.columnOption("Cabinet","width",w.widthCabinet),t.columnOption("Location","width",w.widthLocation)):(w.widthDocID=t.columnOption("Doc ID","width"),w.widthVer=t.columnOption("Ver#","width"),w.widthModified=t.columnOption("Modified","width"),w.widthCategories=t.columnOption("Categories","width"),w.widthCreated=t.columnOption("Created","width"),w.widthAccessed=t.columnOption("Accessed","width"),w.widthSize=t.columnOption("Size","width"),w.widthCabinet=t.columnOption("Cabinet","width"),w.widthLocation=t.columnOption("Location","width")),g.MarkFavView&&w.saveFavView()}},w.displayComments=function(){w.showComments=!w.showComments,w.showComments?w.fontSectionLabel="Hide File List Comments":w.fontSectionLabel="Display File List Comments"},w.showColumnChooser=function(){var l=$(".popup-columnChooser").dxPopup("instance");l.option("position",{my:"right",at:"bottom",of:C.parentColumnChoose}),l.show();var e=$("#gridContainer").dxDataGrid("instance");w.columnarr=[],w.columnarr_item=[];for(var t=0;t<e.columnCount();t++){var i=e.columnOption(t);1==i.showInColumnChooser&&(w.columnarr.push([i.caption,i.dataField]),w.columnarr_item.push(i.caption))}setTimeout(function(){if($(".dx-overlay-wrapper.popup.popup-columnChooser").find(".dx-toolbar-after").html('<div class="dx-item dx-toolbar-item dx-toolbar-button"><div class="dx-item-content dx-toolbar-item-content"><div class="dx-closebutton dx-button dx-button-normal dx-widget dx-button-has-icon" role="button" aria-label="close" tabindex="0"><div class="dx-button-content"><i class="dx-icon dx-icon-close"></i></div></div></div></div>'),$(document).on("click",".dx-closebutton",function(){l.hide()}),$("#dxlist-clm_cbx").dxList("instance").reload(),0<w.columnarr_visivle.length)for(var e=0;e<w.columnarr_visivle.length;e++)$("#dxlist-clm_cbx").dxList("instance").selectItem(w.columnarr_visivle[e]);var i,t=$("#gridContainer").dxDataGrid("instance");w.columnarr=[],w.columnarr_item=[];for(e=0;e<t.columnCount();e++){var o=t.columnOption(e);1==o.showInColumnChooser&&(w.columnarr.push([o.caption,o.dataField]),w.columnarr_item.push(o.caption))}$(document).on("click",".btn-apply-clm-chooser",function(){l.hide();for(var e=$("#hdd-selecteditem").val().split(", "),t=0;t<w.columnarr.length;t++){for(var i=w.columnarr[t],o=0,n=0;n<13;n++)i[0]==e[n]&&(o=1);var a=$("#gridContainer").dxDataGrid("instance");1==o?a.columnOption(i[1],"visible",!0):a.columnOption(i[1],"visible",!1),a.refresh()}-1!=e.indexOf("Ver #")?w.showVersion=!1:w.markVersion&&(w.showVersion=!0),-1!=e.indexOf("Modified")?w.showModified=!1:w.markModified&&(w.showModified=!0),-1!=e.indexOf("Size")?w.showSize=!1:w.markSize&&(w.showSize=!0),-1!=e.indexOf("Created")?w.showCreated=!1:w.markCreated&&(w.showCreated=!0),-1!=e.indexOf("Accessed")?w.showAccessed=!1:w.markAccessed&&(w.showAccessed=!0),-1!=e.indexOf("Doc ID")?w.showDocID=!1:w.markDocId&&(w.showDocID=!0),g.MarkFavView&&w.saveFavView()}),w.buttonOptionsApplyChooser={text:"Apply",height:30,width:120,type:"success",template:function(e,t){$("<div class='button-indicator'></div><span class='dx-button-text'>"+e.text+"</span>").appendTo(t),i=t.find(".button-indicator").dxLoadIndicator({visible:!1,width:16,height:16}).dxLoadIndicator("instance")},onClick:function(e){e.component.option("text","Applying"),i.option("visible",!0),setTimeout(function(){w.applyColumnChooserPopUp(),l.hide(),i.option("visible",!1),e.component.option("text","Apply")},-1)}}},100)},w.$on("eventFired",function(e,t){if("download"==t.type)return w.download(t.file.data),!1;T(w.gridData.component,w.gridData.component.getSelectedRowsData().pop(),w.gridData)}),-1!=v.indexOf("Frowser")?u.attach?(w.dwnIco="ms-Icon ms-Icon--Attach",w.dwnTxt="Attach"):(w.dwnIco="ms-Icon ms-Icon--OpenFile",w.dwnTxt="Open"):(w.dwnIco="ms-Icon ms-Icon--Download",w.dwnTxt="Download"),u.attach&&(w.attach=!0),w.setAttachPop=function(){w.$parent.visiblePopup=!0},w.gridHeader={f1code:"",f1desc:"",f1name:""},w.callFlag=!0,angular.element(r).bind("resize",function(){var e=$("#leftNav").dxResizable("instance").option("width");if(w.wdView){var t=parseInt($("#leftNav").dxResizable("instance").option("width")),i=parseInt(window.innerWidth)-parseInt(t),o=i-parseInt($("#homeFileMenu").css("width"));$("#appBody").css("width",i).css("maxWidth",i),$("#homedataGrid, #gridContainer").css("width",o).css("maxWidth",o)}else $("#appBody, #homedataGrid, #gridContainer").css("width",window.innerWidth-e).css("max-width",window.innerWidth-e);$("#gridContainer").dxDataGrid("instance").option("height",window.innerHeight-145),$(".dx-freespace-row").css("height",1),$("#scrollWk").dxScrollView("instance").option("height",window.innerHeight-150),$("#scrollCab, #fmContainer").dxScrollView("instance").option("height",window.innerHeight-190),$("#dxVerList").dxList("height",window.innerHeight-190),$("#scrollPreview").dxScrollView("instance").option("height",window.innerHeight-165),setTimeout(function(){$("#listTitle").css({"max-width":"0px",width:"0px"}),$("#gridContainer").dxDataGrid("instance")._windowResizeCallBack(),C.setTitleHeaderWidth()},-1)}),C.$watch("wdStatus",function(e,t){if(e!=t)for(var i=0;i<w.items.length;i++)if(w.items[i].RN==C.rec&&"48"==w.items[i].I){if(w.items[i].I="0","1"==C.checkType){var o=parseInt(w.items[i].Version)+1;w.items[i].Version=o}}else w.items[i].RN==C.rec&&"0"==w.items[i].I&&(w.items[i].I="48")}),w.fileActionToolbar={adaptivityEnabled:!0,bindingOptions:{deep:!0,dataSource:"toolBarData"},onContentReady:function(e){setTimeout(function(){e.component._windowResizeCallBack()},4e3)}},w.chkStatus=function(e){var t;"49"===e.I?t="File isn't checkout to you":"52"===e.I&&(t="You do not need to check it in"),w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],w.$parent.dialogTitle="Check-In";var i={title:e.DocId,desc:e.Description,wdMsg:t};w.$parent.fileErrorMessage.push(i),w.$parent.genericError=!1,w.$parent.errorTypeDialog="action",w.$parent.fileError=!0},w.toolBarData=[{location:"before",widget:"dxButton",locateInMenu:"auto",options:{bindingOptions:{icon:"dwnIco",text:"dwnTxt"},elementAttr:{id:"wdOpenFile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance"),i=t.getSelectedRowsData();t.selectRows({DocId:i.pop().DocId},!1),w.download(t.getSelectedRowsData()[0])}}},{location:"before",widget:"dxButton",options:{icon:"ms-Icon ms-Icon--PageCheckedOut",text:"Check-Out",elementAttr:{id:"wdChkOut"},onClick:function(e){y(e)}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--Edit",text:"Edit Profile",elementAttr:{id:"wdEditProfile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance");if(0==t.getSelectedRowsData().length)return DevExpress.ui.notify("Please select a file!","error"),!1;l.getDataGridControlerScope(e);var i={row:{data:t.getSelectedRowsData().pop()}};s.setSelected(t.getSelectedRowsData()),l.openPanel(i,e,0,"Profile","toolbar"),e.model.$parent.$parent.checked=!0,C.$broadcast("editIcon",{flag:"Edit"})}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--Copy",text:"Copy",elementAttr:{id:"wdCopyProfile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance");if(0==t.getSelectedRowsData().length)return DevExpress.ui.notify("Please select a file!","error"),!1;l.getDataGridControlerScope(e);var i={row:{data:t.getSelectedRowsData().pop()}};s.setSelected(t.getSelectedRowsData()),l.openPanel(i,e,0,"Profile","toolbar"),e.model.$parent.$parent.checked=!0,C.$broadcast("editIcon",{flag:"Copy"})}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--Mail",text:"Email",elementAttr:{id:"wdEmail"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance");if(0==t.getSelectedRowsData().length)return DevExpress.ui.notify("Please select a file!","error"),!1;l.getDataGridControlerScope(e);var i={row:{data:t.getSelectedRowsData()[0]}};s.setSelected(t.getSelectedRowsData()),l.openPanel(i,e,1,"Email","toolbar"),w.$parent.dialogTitle="Email",e.model.$parent.$parent.checked=!0,"54"==t.getSelectedRowsData()[0].I?$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!0:$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!1}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--EntryView",text:"View",elementAttr:{id:"wdViewFile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance"),i={row:{data:t.getSelectedRowsData().pop()}};l.getDataGridControlerScope(e);e.model.$parent.$parent.wdView=!0,l.openPanel(i,e,0,"Preview","toolbar"),T(w.gridData.component,w.gridData.component.getSelectedRowsData().pop(),w.gridData),setTimeout(function(){$("#listTitle").css({"max-width":"0px",width:"0px"}),t._windowResizeCallBack(),C.setTitleHeaderWidth()},-1)}}},{location:"before",widget:"dxButton",options:{icon:"ms-Icon ms-Icon--Refresh",text:"Refresh",onClick:function(e){$("#gridContainer").dxDataGrid("instance").refresh()}}}],w.fieldContainer={Field1:!1,Field2:!1,Field3:!1,Field4:!1,Field5:!1,Field6:!1,Field7:!1},w.emailData={},w.setVersion=function(e){var t="";u.attach&&u.noEdit&&(t="&attach=1&noEdit=1"),r.open("./home?verid="+e.LID+"&verRec="+e.RN+"&typeid=version"+t,"_blank")},w.setCategory=function(e,i,t){""!=w.rowSetCate&&(i=w.rowSetCate),d.addRemoveCat(e,i.row.data,t).then(function(e){var t=e.data.category;if(""!==t.errorStatus.ErrorCount)return DevExpress.ui.notify(t.errorStatus.wd_Error_MSG,"error",4e3),!1;i.component.refresh()},function(e){i.component.refresh()})},w.getHeight=function(e){if(e)return window.innerHeight-145;c(function(){$("#gridContainer").height(window.innerHeight-145)},0)},w.getWidth=function(){setTimeout(function(){return window.innerWidth-$("#leftNav").width()},-1)},w.setFavorite=function(e,t,i,o){d.setFields(e,t,i,o).then(function(e){var t=e.data;if(""!=t.setField.errorStatus.ErrorCount)return DevExpress.ui.notify(t.setField.errorStatus.wd_Error_MSG,"error",4e3),!1;switch(o.FF){case"2147483725":case"11907":case"11501":case"11303":case"11301":case"1":o.FF="0";break;default:o.FF="2147483725"}},function(e){DevExpress.ui.notify("Server Error","error",4e3)})},w.checkin={uploadUrl:g.host+g.uploadLocation,bindingOptions:{multiple:"multiple",accept:"accept",value:"value",uploadMode:"uploadMode"},visible:!1,onUploadError:function(e){DevExpress.ui.notify("Upload failed! "+e.request.statusText,"error",4e3)},onUploaded:function(e){if("N"==C.checkinType)return w.uploadToWldox("1",e.file.name),!1;w.uploadToWldox("",e.file.name)},onUploadStarted:function(e){var t=$("#gridContainer").dxDataGrid("instance").getSelectedRowsData()[0].LN;$("#wdDesc"+t).dxLoadIndicator("instance").option("visible",!0)}},w.setDescLoaderId=function(e){return"wdDesc"+e.LN},w.descLoader={height:16,width:16,visible:!1},w.uploadToWldox=function(i,o){var e=m.getSelectedRowsData(),n={RN:e[0].RN,LID:e[0].LID,LN:e[0].LN};d.uploadToWorldox(i,n,o).then(function(e){var t=e.data.uploadVerb;if(""!=t.errorStatus.ErrorCount)return DevExpress.ui.notify(t.errorStatus.wd_Error_MSG,"error",4e3),!1;w.checkToWdx(n,o,i)},function(e){DevExpress.ui.notify("IIS Error","error",4e3)})},w.checkToWdx=function(i,e,o){var n=m.getSelectedRowsData(),a=$("#gridContainer").dxDataGrid("instance");d.chkToWorldox(i,e).then(function(e){if(w.$parent.fileSuccessMessage=[],w.$parent.fileErrorMessage=[],""!=e.data.fileStatus.errorStatus.ErrorCount){var t={title:n[0].DocId,desc:n[0].Description,wdMsg:"File checked-in successfully"};return w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,a.refresh(),!1}C.rec=i.RN,C.wdStatus=Math.round(new Date/1e3),C.checkType=o,n[0].I="0";t={title:n[0].DocId,desc:n[0].Description,wdMsg:"File checked-in successfully"};w.$parent.fileSuccessMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,a.refresh()},function(e){DevExpress.ui.notify("IIS Error","error",4e3)})},w.getTypeLogo=function(e){switch(e){case"DOCX":case"DOC":case"DOTX":case"ODT":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--word'></div>";case"CSV":case"ODS":case"XLS":case"XLSX":case"XLTX":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--excel'></div>";case"MSG":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--outlook'></div>";case"ODP":case"POTX":case"PPSX":case"PPTX":case"ODP":case"POT":case"PPS":case"PPT":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--powerpoint'></div>";case"PDF":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--pdf'></div>";case"JPG":case"PNG":case"GIF":case"JPEG":case"TIFF":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--image'></div>";default:return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--filler'></div>"}},w.getIconTitle=function(e){switch(e.I){case"49":return"";case"51":return"Hidden by you";case"52":return"File Secured by:"+e.OW;case"53":return"";case"54":return"Read only access";case"55":return"";case"56":return"Your a Manager with access"}},w.getStatusIcon=function(e){switch(e){case"49":return"dx-icon ms-Icon ms-Icon--nothing";case"51":return"dx-icon ms-Icon ms-Icon--UnlockSolid statusGreen";case"52":return"dx-icon ms-Icon ms-Icon--LockSolid statusGreen";case"53":case"54":return"dx-icon ms-Icon ms-Icon--LockSolid statusYellow";case"55":case"56":return"dx-icon ms-Icon ms-Icon--LockSolid statusRed"}},w.getTilt=function(e){return decodeURI(e)},w.editFields={field1:"",field2:"",field3:"",field4:"",field5:"",field6:"",field7:"",placeholder1:"",placeholder2:"",placeholder3:"",placeholder4:"",placeholder5:"",placeholder6:"",placeholder7:"",description:"",comment:"",placeholderCo:"Comments",placeholderDesc:"Description"},w.setCatToolTip=function(e){return{target:"#toolTip"+e,showEvent:"dxhoverstart",hideEvent:"dxhoverend"}},w.setTipID=function(e,t){return t?"toolTip"+e:"tipId"+e},w.getContextual=function(e){$(".hoverMore").on("dxclick",function(e){var t=$.extend({},e,{type:"dxcontextmenu"});$(this).trigger(t)})},w.loadOpen={shadingColor:"rgba(256,256,256,0.2)",position:{of:window},bindingOptions:{visible:"loadingVisible"}},w.download=function(l,e){w.dwnSpinner=!1,w.loadingVisible=!0,w.$parent.fileSuccessMessage=[],w.$parent.fileErrorMessage=[],w.$parent.dialogTitle="Download",d.download(l).then(function(o){var e=o.data.download;if(""!=e.errorStatus.ErrorCount){var t={title:l.DocId,desc:l.Description,wdMsg:e.errorStatus.wd_Error_MSG};w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(e.message){t={title:l.DocId,desc:l.Description,wdMsg:e.message};w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(-1!=v.indexOf("Frowser"))w.$parent.dialogTitle=w.dwnTxt,d.getFolderLevel().then(function(e){for(var t=0;t<e.data.root.Cabinets.length;t++){var i=e.data.root.Cabinets[t].pgFields.split("|");if(e.data.root.Cabinets[t].pgID==l.profileGroupId&&"54"!==l.I)return w.checkAttachment(l,o.data,i),!1;e.data.root.Cabinets[t].pgID==l.profileGroupId&&"54"==l.I&&(w.$parent.userType="readOnly",w.$parent.errorTypeDialog="user",w.$parent.fileError=!0,w.$parent.wdDocId=l.DocId,w.$parent.wdDesc=l.Description,w.$parent.wdErr="The file is READ-ONLY (per it's security settings).",w.$parent.wdQuestion="Open a Read-ONLY copy?",w.saveReadOnlyData={fileData:o.data,resData:l,folderData:i})}},function(e){$log.error(e),DevExpress.ui.notify("IIS error 500","error",4e3)});else{if("PDF"===l.Extension)return w.dwnSpinner=!0,w.loadingVisible=!1,r.open(g.host+o.data.download.fileLoc,"_blank"),!1;if("WDL"===l.Extension){w.dwnSpinner=!0,w.loadingVisible=!1;var i=decodeURIComponent(l.FilePath+"\\"+l.DocId),n=encodeURIComponent(i);return r.open("./home?query=Project: "+encodeURIComponent(n),"_blank"),!1}var a={title:l.DocId,desc:l.Description,wdMsg:"File downloaded Succesfully"};w.$parent.fileSuccessMessage.push(a),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,r.location.href=g.host+o.data.download.fileLoc}w.dwnSpinner=!0,w.loadingVisible=!1},function(e){w.dwnSpinner=!0,w.loadingVisible=!1,DevExpress.ui.notify("IIS error 500","error",4e3)})},w.checkAttachment=function(e,t,i){if(u.noEdit)return w.saveReadOnlyData={fileData:t,resData:e,folderData:i},w.getResponse(w.saveReadOnlyData.fileData,w.saveReadOnlyData.resData,w.saveReadOnlyData.folderData),!1;w.checkedOut(e,t,i)},w.getCatList=function(e){var t=document.createElement("ul");t.classList.add("tipList");for(var i=0;i<e.CAT_ID.length;i++){var o=document.createElement("li");o.innerHTML="<img src='"+C.host+e.CAT_ID[i].CI+"' width='8' height='8' /> "+e.CAT_ID[i].CD,t.appendChild(o)}return t.outerHTML},w.checkedOut=function(t,i,o){if("WDL"===t.Extension){w.dwnSpinner=!0,w.loadingVisible=!1,w.dwnloadSpinner=!0;var e=decodeURIComponent(t.FilePath+"\\"+t.DocId),n=encodeURIComponent(e);return r.open("./home?query=Project: "+encodeURIComponent(n),"_blank"),!1}d.checkout(t).then(function(e){if("The file already checked-out to someone else"==e.data.fileStatus.errorStatus.wd_Error_MSG||"Unsufficient file rights"==e.data.fileStatus.errorStatus.wd_Error_MSG||"The file is already checked-out to you"==e.data.fileStatus.errorStatus.wd_Error_MSG||""==e.data.fileStatus.errorStatus.ErrorCount)return w.getResponse(i,t,o),!1;DevExpress.ui.notify(e.data.fileStatus.errorStatus.wd_Error_MSG,"error",4e3)},function(e){$log.log(e)})},w.getResponse=function(e,t,i){var o=0,n=e.download.FileZMS.replace(/\\/g,"\\\\"),a=$("#gridContainer").dxDataGrid("instance").getSelectedRowsData()[0];i.shift();for(var l=0;l<i.length;l++)""!==i[l]?i[l]=a["Field"+(l+1)]:i[l]="";w.$parent.fileError=!1,("54"==a.I||"49"==a.I||u.noEdit)&&(o=1),c(function(){r.location=g.host+"/cgi-bin/wdwebcgi.exe?SERVE+wd_SID="+g.userData.session+"+html=/api/apiList.json+dwLoc="+e.download.fileLoc+"+name="+e.download.FileNme+"+domain="+g.host+"+cabinet="+t.profileGroupId+"+f1="+i[0]+"+f2="+i[1]+"+f3="+i[2]+"+f4="+i[3]+"+f5="+i[4]+"+f6="+i[5]+"+f7="+i[6]+"+popFlag="+w.softpopFlag+"+zms="+n+"+readOnly="+o,w.updateList(a),w.dwnloadSpinner=!0},-1e3)},w.updateList=function(t){d.getFileProfile(t).then(function(e){t.I="48",t.CHKOUT_TO_PREF=e.data.file.CTOP,t.CHKOUT_TO_NAME=e.data.file.CTON,t.CHKOUT_ON_PREF=e.data.file.CONP,t.CHKOUT_ON_DATE=e.data.file.COND},function(e){console.log(e)})},w.loadHeader=function(e){w.gridHeader={f1code:void 0!==e?e.Field1:"",f1desc:void 0!==e?e.Field1Desc:"",f1name:void 0!==e?e.Field1Name:"",f2code:void 0!==e?e.Field2:"",f2desc:void 0!==e?e.Field2Desc:"",f2name:void 0!==e?e.Field2Name:"",f3code:void 0!==e?e.Field3:"",f3desc:void 0!==e?e.Field3Desc:"",f3name:void 0!==e?e.Field3Name:"",f4code:void 0!==e?e.Field4:"",f4desc:void 0!==e?e.Field4Desc:"",f4name:void 0!==e?e.Field4Name:"",f5code:void 0!==e?e.Field5:"",f5desc:void 0!==e?e.Field5Desc:"",f5name:void 0!==e?e.Field5Name:"",f6code:void 0!==e?e.Field6:"",f6desc:void 0!==e?e.Field6Desc:"",f6name:void 0!==e?e.Field6Name:"",f7code:void 0!==e?e.Field7:"",f7desc:void 0!==e?e.Field7Desc:"",f7name:void 0!==e?e.Field7Name:""}},w.checkInId=function(e){return"checkInLink"+e.LN},w.checkInSelectType=[{text:"Revert",value:"r",onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance"),i=parseInt(w.wdSelecteFile.LN)-1;t.selectRowsByIndexes(i),function(e){$("#gridContainer").dxDataGrid("instance").getSelectedRowsData();w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],w.$parent.dialogTitle="Check-In",w.checkInput(e)}(w.wdSelecteFile)}},{text:"Overwrite",value:"o",onClick:function(e){var t=$("#checkin").dxFileUploader("instance");t._isCustomClickEvent=!0,t._$fileInput.click(),C.checkinType="R"}},{text:"New version",value:"v",onClick:function(e){var t=$("#checkin").dxFileUploader("instance");t._isCustomClickEvent=!0,t._$fileInput.click(),C.checkinType="N"}}],w.contextMenuTemplate=function(e){return{target:"#checkInLink"+e.LN,dataSource:w.checkInSelectType,elementAttr:{id:"checkInMenu"+e.LN}}},w.checkInFrom=function(e){$("#checkInMenu"+e.LN).dxContextMenu("toggle",!0),w.wdSelecteFile=e},w.setToolbarStatus=function(e){var t,i;if(void 0===e)t=!(i="#wdOpenFile, #wdChkOut, #wdEditProfile, #wdCopyProfile, #wdEmail, #wdViewFile");else switch(e.I){case"54":i="#wdChkOut, #wdEditProfile, #wdCopyProfile",t=!0;break;case"55":i="#wdOpenFile, #wdChkOut, #wdEditProfile, #wdCopyProfile, #wdEmail, #wdViewFile",t=!0;break;default:t=!(i="#wdOpenFile, #wdChkOut, #wdEditProfile, #wdCopyProfile, #wdEmail, #wdViewFile")}$(i).each(function(){$(this).dxButton("instance").option("disabled",t)})},w.checkOutput=function(o){return d.checkout(o).then(function(e){var t=e.data.fileStatus;if(""!=t.errorStatus.ErrorCount)return w.errorType(t,!0,o),!1;var i={title:o.DocId,desc:o.Description,wdMsg:"File Checked out Succesfully"};w.$parent.fileSuccessMessage.push(i),C.wdStatus=Math.round(new Date/1e3),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,w.dwnload(o,!0)}),!0},w.errorType=function(e,t,i){var o;if(""!==e.errorStatus.wd_Error_DOCID)return o={title:i.DocId,desc:i.Description,wdMsg:e.errorStatus.wd_Error_MSG},w.$parent.fileErrorMessage.push(o),w.$parent.genericError=!1,w.$parent.errorTypeDialog="action",!(w.$parent.fileError=!0);o={wdMsg:e.errorStatus.wd_Error_MSG},w.$parent.fileErrorMessage.push(o),w.$parent.genericError=!0,w.$parent.errorTypeDialog="action",w.$parent.fileError=!0},w.checkInput=function(o){return d.checkIn(o).then(function(e){var t=e.data.fileStatus;if(""!=t.errorStatus.ErrorCount)return w.errorType(t,!0,o),!1;var i={title:o.DocId,desc:o.Description,wdMsg:"File Checked in Succesfully"};w.$parent.fileSuccessMessage.push(i),o.I="0",w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}),!0},w.currentDeleteFiles={},w.visibleDeletePopup=!1,w.width_popupDel=550,$(window).width()<768&&(w.width_popupDel="80%"),w.popupOptions={width:w.width_popupDel,height:"auto",contentTemplate:"delete",showTitle:!0,title:"Delete",dragEnabled:!1,closeOnBackButton:!1,closeOnOutsideClick:!1,showCloseButton:!1,bindingOptions:{visible:"visibleDeletePopup"}},w.showDeletePopup=function(e){w.currentDeleteFiles=e,w.visibleDeletePopup=!0},C.$on("openDeletePopup",function(e,t){w.currentDeleteFiles=t,w.visibleDeletePopup=!0}),w.validateGroup={validationRules:[{type:"required",message:"Please select a Delete method"}]},w.applyDeleteButtonOptions={text:"Ok",type:"success",width:90,useSubmitBehavior:!0},w.deleteData=function(){w.visibleDeletePopup=!1,angular.forEach(w.currentDeleteFiles,function(i,e){d.deleteFile(i,w.deleteValue).then(function(e){var t=e.data;if(w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],""!==t.fileStatus.errorStatus.ErrorCount)return w.$parent.dialogTitle="Delete",w.errorType(t.fileStatus,!0,i),!1;$("#gridContainer").dxDataGrid("instance").refresh()})})},w.cancelDeleteButtonOptions={text:"Cancel",type:"danger",width:90,onClick:function(e){w.visibleDeletePopup=!1}},w.dwnload=function(n,a){w.dwnloadSpinner=!1;var l={RN:n.RN,LID:n.LID,LN:n.LN,PGID:n.profileGroupId,Field1:n.Field1,Field2:n.Field2,Field3:n.Field3,Field4:n.Field4,Field5:n.Field5,Field6:n.Field6,Field7:n.Field7};d.download(l).then(function(o){w.$parent.fileErrorMessage=[];var e=o.data.download;if(""!==e.errorStatus.ErrorCount){var t={title:l.DocId,desc:l.Description,wdMsg:e.errorStatus.wd_Error_MSG};w.dwnloadSpinner=!0,w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(e.message){t={title:l.DocId,desc:l.Description,wdMsg:e.errorStatus.wd_Error_MSG};w.dwnloadSpinner=!0,w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(-1!=v.indexOf("Frowser"))d.getFolderLevel().then(function(e){for(var t=0;t<e.data.root.Cabinets.length;t++)if(e.data.root.Cabinets[t].pgID==l.PGID){var i=e.data.root.Cabinets[t].pgFields.split("|");return w.checkedOut(l,o.data,i),!1}},function(e){w.dwnloadSpinner=!0,$log.error(e),DevExpress.ui.notify("IIS error 500","error",4e3)});else{if(w.dwnloadSpinner=!0,1!=a){w.$parent.fileSuccessMessage=[];var i={title:l.DocId,desc:l.Description,wdMsg:"File downloaded Succesfully"};w.$parent.fileSuccessMessage.push(i),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}w.dwnloadSpinner=!0,r.location.href=g.host+o.data.download.fileLoc,w.updateList(n)}},function(e){$log.error(e)})},w.isPopupVisible=!1,w.popupCustomizeOptions={width:210,height:120,contentTemplate:"info",showTitle:!1,dragEnabled:!1,closeOnOutsideClick:function(){w.isPopupVisible=!w.isPopupVisible},position:{my:"left",at:"bottom",of:"#btnCustomize"},bindingOptions:{visible:"isPopupVisible"}},w.cancelCustomizeListView=function(){w.isPopupVisible=!1},w.applyCustomerListView=function(){w.isPopupVisible=!1,w.saveFavView()},w.isPopupVisibleColumnChooser=!1,w.popupColumnChooserOptions={width:250,height:320,contentTemplate:"info",title:"Column Chooser",dragEnabled:!0,closeOnOutsideClick:!1,closeOnBackButton:!1,showCloseButton:!0,position:{my:"left",at:"bottom",of:C.parentColumnChoose},bindingOptions:{visible:"isPopupVisibleColumnChooser"}},w.setComments=function(e){return"<i class='ms-Icon ms-Icon--Comment listComments' aria-hidden='true'></i><span pg-clamp='2' class='commentTxt'>"+e+"</span>"},w.deleteList=[{text:"Move to Salvage Bin",value:parseInt(16384)+parseInt(72)},{text:"Delete",value:16384},{text:"Shred (unrecoverable)",value:65536}],w.delGroup={items:w.deleteList,itemTemplate:function(e,t,i){i.parent().text(e.text)},onValueChanged:function(e){w.deleteValue=e.value.value}},w.applyColumnChooserPopUp=function(){w.isPopupVisibleColumnChooser=!1,w.isPopupVisible=!1;var e=$("#hdd-selecteditem").val().split(", "),t=$("#gridContainer").dxDataGrid("instance");t.beginUpdate();for(var i=0;i<w.columnarr.length;i++){for(var o=w.columnarr[i],n=0,a=0;a<e.length;a++)o[0]==e[a]&&(n=1);1==n?t.columnOption(o[1],"visible",!0):t.columnOption(o[1],"visible",!1)}t.endUpdate(),-1!=e.indexOf("Ver #")?w.showVersion=!1:w.markVersion&&(w.showVersion=!0),-1!=e.indexOf("Modified")?w.showModified=!1:w.markModified&&(w.showModified=!0),-1!=e.indexOf("Size")?w.showSize=!1:w.markSize&&(w.showSize=!0),-1!=e.indexOf("Created")?w.showCreated=!1:w.markCreated&&(w.showCreated=!0),-1!=e.indexOf("Accessed")?w.showAccessed=!1:w.markAccessed&&(w.showAccessed=!0),-1!=e.indexOf("Doc ID")?w.showDocID=!1:w.markDocId&&(w.showDocID=!0),g.MarkFavView&&w.saveFavView()},w.saveFavView=function(){for(var t=$("#gridContainer").dxDataGrid("instance"),e=t.getVisibleColumns().filter(function(e){return e.showInColumnChooser}).map(function(e){return e.caption}),i=t.getVisibleColumns().filter(function(e){return e.showInColumnChooser}).map(function(e){return t.columnOption(e.caption,"width")}),o=[],n=$("#gridContainer").dxDataGrid("instance"),a=0;a<n.columnCount();a++){var l=n.columnOption(a);o.push(l.visibleIndex)}g.ColumnsIndex=o,g.MarkFavView=!0,g.ColumnsChooser=e,g.DescriptionWidth=t.columnOption("Description","width"),g.ColumnsWidths=i,localStorage.setItem("ngStorage-ColumnsWidths",JSON.stringify(i)),-1!=e.indexOf("Comments")?w.showComments=!1:w.showComments=!0,-1!=e.indexOf("Ver #")?w.showVersion=!1:w.markVersion&&(w.showVersion=!0),-1!=e.indexOf("Modified")?w.showModified=!1:w.markModified&&(w.showModified=!0),-1!=e.indexOf("Size")?w.showSize=!1:w.markSize&&(w.showSize=!0),-1!=e.indexOf("Created")?w.showCreated=!1:w.markCreated&&(w.showCreated=!0),-1!=e.indexOf("Accessed")?w.showAccessed=!1:w.markAccessed&&(w.showAccessed=!0),-1!=e.indexOf("Doc ID")?w.showDocID=!1:w.markDocId&&(w.showDocID=!0)},w.hoverDescription=function(e){var t=e.currentTarget.parentElement;if(t.scrollWidth>t.clientWidth){var i=e.currentTarget.innerHTML;w.ttl_dsc=i}else w.ttl_dsc=" "},C.setTitleHeaderWidth=function(){$("#listTitle").css({"max-width":"0px",width:"0px"});var e=$("#gridContainer .dx-datagrid-header-panel").width(),t=$("#gridContainer .dx-datagrid-header-panel .dx-toolbar-after").width(),i=parseInt(e)-parseInt(t)-50;setTimeout(function(){$("#listTitle").css({"max-width":i+"px",width:i+"0px"})},100)}}angular.module("WDWeb"),dataGridController.$inject=["$scope","$http","$localStorage","$location","$q","$window","fileListUI","uxService","wdService","uploader","homeService","$rootScope","$timeout"],angular.module("WDWeb").controller("dataGridController",dataGridController);
=======
"use strict";function dataGridController(w,n,g,e,a,r,c,t,d,i,l,C,p){var s=e.search().query,u=e.search();w.getQuery=u;var m,o={},v=r.navigator.userAgent,h=!0,f=g.ColumnsChooser||["Doc ID","Ver #","Modified","Categories","Updated","Size"];w.dwnIco,w.dwnTxt,w.openTypeSelected={},w.openTypeVerList={};var D,x,I=!!document.documentMode;if(w.showComments=!0,null!=g.showComments&&(w.showComments=g.showComments),w.selectedFile="",C.host=g.host,w.listFailed=!1,w.tableLoader=!0,w.queryTitle=s,w.softpopFlag=1,w.checked=!1,C.tabTypeFlag=!0,w.sortType=1,w.sortFlag=!1,w.columnID="5375",w.shareMenu=[],w.loadingVisible=!1,w.attach=!1,w.gridMessage="",w.showVersion=!1,w.showComment=!0,w.showDocID=!1,w.showModified=!1,w.sortColumn="asc",w.showCheckout=!0,w.showWorkFlow=!0,w.ttl_dsc=" ",w.setIconWidth,w.showPagination=!0,C.parentColumnChoose="#btnColumnChooser",w.deleteValue="",w.showSize=!1,w.showCreated=!1,w.showAccessed=!1,w.showName=!1,w.markModified=!1,w.markSize=!1,w.markCreated=!1,w.markVersion=!1,w.markAccessed=!1,w.markDocId=!1,w.maxWidthDesc=800,w.categoryMenu=[],w.showPageSize=!1,w.pageSize=50,w.$on("openReadOnly",function(e){w.getResponse(w.saveReadOnlyData.fileData,w.saveReadOnlyData.resData,w.saveReadOnlyData.folderData)}),w.$on("setWDGridLoader",function(e){w.tableLoader=!0}),w.popupFileChangedOptions={width:350,height:170,contentTemplate:"popupFileChangedTemplate",showTitle:!0,title:"Error",dragEnabled:!1,closeOnOutsideClick:!1,bindingOptions:{visible:"visiblePopupFileChangedOptions"}},w.visiblePopupFileChangedOptions=!1,C.$on("showMessageWhenFileChanged",function(e,t){$("#popupFileChangedOptions").dxPopup().dxPopup("instance").show()}),C.$on("hideMessageWhenFileChanged",function(e,t){$("#popupFileChangedOptions").dxPopup().dxPopup("instance").hide(),w.$parent.checked=!1,w.$parent.wdView=!1}),w.cancelCommandChangeFile=function(){C.$broadcast("hideMessageWhenFileChanged")},w.$on("updateDataGrid",function(e,t){$("#gridContainer").dxDataGrid("instance").getSelectedRowsData()[0].I="0"}),w.$on("fileAction",function(e,t){var i=$("#gridContainer").dxDataGrid("instance"),o=i.getSelectedRowsData();switch(t.type){case"download":w.download(i.getSelectedRowsData()[0]);break;case"checkOut":y(t.data);break;case"editProfile":c.getDataGridControlerScope(t.data);for(var n={row:{data:i.getSelectedRowsData().pop()}},a=1;a<=7;a++)""!=n.row.data["Field"+a]?(w.fieldContainer["Field"+a]=!0,w.editFields["placeholder"+a]=n.row.data["Field"+a+"Name"],w.editFields["field"+a]=n.row.data["Field"+a]):w.fieldContainer["Field"+a]=!1;l.setSelected(i.getSelectedRowsData()),w.$parent.selectedTab="Profile",C.$broadcast("editIcon",{flag:t.profile}),$("#tabPanelItems").dxTabPanel("instance").option("selectedIndex",0),console.log(n.row.data),w.toggle(n.row.data,!0),w.$parent.checked=!0;break;case"eMail":c.getDataGridControlerScope(t.data),n={row:{data:i.getSelectedRowsData().pop()}};l.setSelected(i.getSelectedRowsData()),$("#tabPanelItems").dxTabPanel("instance").option("selectedIndex",1),w.toggle(n.row.data,!0),w.$parent.dialogTitle=t.profile,w.$parent.checked=!0,"54"==i.getSelectedRowsData()[0].I?$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!0:$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!1;break;case"view":n={row:{data:o.pop()}},c.getDataGridControlerScope(t.data);w.$parent.wdView=!0,$("#gridContainer").css("max-width","none").css("width",""),T(w.gridData.component,w.gridData.component.getSelectedRowsData().pop(),w.gridData),setTimeout(function(){$("#listTitle").css({"max-width":"0px",width:"0px"}),i._windowResizeCallBack(),C.setTitleHeaderWidth()},-1);break;case"reFresh":w.tableLoader=!0,i.refresh()}}),w.$on("fileActionOpen",function(e,t){if(t.listId)return w.setVersion(t.data),!1;w.chkDwnLoadType(t)}),w.wdFilterBox={placeholder:"Filter",elementAttr:{class:"wdFilterBox",id:"wdFilterBox"},onEnterKey:function(e){w.filterGrid(e.event.target.value)},showClearButton:!0},w.wdFilterBtn={icon:"ms-Icon ms-Icon--Accept",onClick:function(e){var t=$("#wdFilterBox").dxTextBox("instance").option("value");w.filterGrid(t)},elementAttr:{class:"wdFilterBtn"}},w.filterGrid=function(e){$("#gridContainer").dxDataGrid("instance").searchByText(e)},w.chkDwnLoadType=function(e){if(u.attach&&e.attType)return w.$parent.changeDialogOption=!1;w.download(e.data)},w.commentLineNumber="",w.fontUnderline="unset",w.fontItalic="normal",w.fontStrikeout=0,w.fontColor="#333",w.fontPaddingl=0,w.fontPaddingr=0,w.fontPaddingt=0,w.fontPaddingb=0,w.fontSectionLabel="Hide Comments",0==w.showComments&&(w.fontSectionLabel="Display Comments"),w.fontName="Calibri",w.fontId=0,w.fontPointsize=14,w.fontWeight=400,w.fontHeight=20,w.fontStyle=[],w.setFontData=function(){n.get(g.host+"cgi-bin/wdwebcgi.exe?FONTGET+wd_SID="+g.userData.session+"+html=/api/font/getfonts.json+wduser="+g.userData.username.split("@")[0]+"+wdIdUn="+Date.now()).then(function(e){if(w.setCss(e.data.root.items),w.commentLineNumber=parseInt(e.data.root.Extra.MaxCommentLines),-1!=navigator.userAgent.indexOf("Firefox")&&(w.commentLineNumber+=parseInt(1)),e.data.root){w.fontStyle=e.data.root.items.map(function(e){return e}),w.fontStyle=angular.fromJson(w.fontStyle);for(var t=0;t<w.fontStyle.length;t++){var i=w.fontStyle[t].crTEXT;i<0&&(i=4294967295+i+1),w.fontStyle[t].crTEXT=i.toString(16).toUpperCase(),1==w.fontStyle[t].bITALIC?w.fontStyle[t].bITALIC="italic":w.fontStyle[t].bITALIC="normal",1==w.fontStyle[t].bUNDERLINE||1==w.fontStyle[t].bSTRIKEOUT?1==w.fontStyle[t].bUNDERLINE?w.fontStyle[t].bUNDERLINE="underline":w.fontStyle[t].bUNDERLINE="line-through":w.fontStyle[t].bUNDERLINE="unset";screen.height;w.fontStyle[t].uHEIGHT="1.1em"}}},function(e){return DevExpress.ui.notify("Server error time out!","error",4e3),a.reject("Data Loading Error")})},w.propertyLineSetting=[],n.get(g.host+"cgi-bin/wdwebcgi.exe?SERVE+wd_SID="+g.userData.session+"+html=/api/ini/iniRead.json+szSection=List%20View+szINI=1+szKey=PropLineProfIDs+wduser="+g.userData.username.split("@")[0]+"+wdIdUn="+Date.now()).then(function(e){if(e.data.root){var t=e.data.root.PropLineProfIDs;w.propertyLineSetting=t.split(",");for(var i=0;i<w.propertyLineSetting.length;i++)switch(w.propertyLineSetting[i]){case"4":w.showModified=!0,w.markModified=!0;break;case"6":w.showSize=!0,w.markSize=!0;break;case"9":w.showCreated=!0,w.markCreated=!0;break;case"20":w.showVersion=!0,w.markVersion=!0;break;case"23":w.showAccessed=!0,w.markAccessed=!0;break;case"2":w.showDocID=!0,w.markDocId=!0}for(i=0;i<f.length;i++)"Comments"==f[i]&&(w.showComments=!1),"Ver #"==f[i]&&(w.showVersion=!1),"Modified"==f[i]&&(w.showModified=!1),"Doc ID"==f[i]&&(w.showDocID=!1),"Size"==f[i]&&(w.showSize=!1),"Created"==f[i]&&(w.showCreated=!1),"Accessed"==f[i]&&(w.showAccessed=!1)}},function(e){return DevExpress.ui.notify("Server error time out!","error",4e3),a.reject("Data Loading Error")}),w.multiple=!1,w.accept="*",w.value=[],w.uploadMode="instantly",w.selectedText="",w.widthDes="75%",$(window).width()<=1024&&(w.widthDes="30%"),w.widthFit="240",$(window).width()<=414&&(w.widthFit=295),$(window).width()<=375&&(w.widthFit=255),$(window).width()<=360&&(w.widthFit=240),$(window).width()<=320&&(w.widthFit=200),g.ColumnsChooser){for(var _=g.ColumnsWidths,S=g.ColumnsChooser,b=0;b<_.length;b++)switch(S[b]){case"Ver #":w.widthVer=_[b];break;case"Doc ID":w.widthDocID=_[b];break;case"Categories":w.widthCategories=_[b];break;case"Created":w.widthCreated=_[b];break;case"Accessed":w.widthAccessed=_[b];break;case"Updated":case"Modified":w.widthUpdated=_[b];break;case"Size":w.widthSize=_[b];break;case"Cabinet":w.widthCabinet=_[b];break;case"Location":w.widthLocation=_[b]}w.widthDes=g.DescriptionWidth}else w.widthVer=70,w.widthDocID=120,w.widthCategories=180,w.widthCreated=180,w.widthAccessed=180,w.widthModified=180,w.widthUpdated=180,w.widthSize=80,w.widthCabinet=100,w.widthLocation=200;w.setCss=function(e){var t=".lineOne { font-size: "+e[10].uPOINTSIZE+"pt; font-style: "+e[10].bITALIC+"; text-decoration: "+e[10].bUNDERLINE+"; color: "+e[10].crTEXT+"; font-family: "+e[10].szFACENAME+"; font-weight: "+e[10].uWEIGHT+" }",i=".chkLabel { font-size: "+e[7].uPOINTSIZE+"pt; font-family: "+e[7].szFACENAME+"; font-style: "+e[7].bITALIC+"; color: "+e[7].crTEXT+"; font-weight: "+e[7].uWEIGHT+" }",o=".chkName { font-style: "+e[6].bITALIC+"; text-decoration: "+e[6].bUNDERLINE+"; color: "+e[6].crTEXT+"; font-family: "+e[6].szFACENAME+"; font-weight: "+e[6].uWEIGHT+"; line-height: "+e[6].uHEIGHT+"; font-size: "+e[6].uPOINTSIZE+"pt; }",n=".chkLink { font-size: "+e[7].uPOINTSIZE+"pt };",a=".chkPadding { padding-top: "+e[7]["RC.TOP"]+"px; padding-bottom: "+e[7]["RC.BOTTOM"]+"px;}",l=".commLine { font-size: "+e[1].uPOINTSIZE+"pt; line-height: "+e[1].uHEIGHT+"overflow: hidden; position: relative; font-style: "+e[1].bITALIC+"; text-decoration: "+e[1].bUNDERLINE+"; color: "+e[1].crTEXT+"; font-family: "+e[1].szFACENAME+"; font-weight: "+e[1].uWEIGHT+"; }",r=(e[1]["RC.TOP"],e[1]["RC.RIGHT"],e[1]["RC.BOTTOM"],e[1]["RC.LEFT"],".propLabel { font-size: "+e[9].uPOINTSIZE+"pt; text-decoration: "+e[9].bUNDERLINE+"; color: "+e[9].crTEXT+"; font-family: "+e[9].szFACENAME+"; font-weight: "+e[9].uWEIGHT+"; line-height: "+e[9].uHEIGHT+"; }"),d=".propValue { font-size: "+e[8].uPOINTSIZE+"pt; text-decoration: "+e[8].bUNDERLINE+"; color: "+e[8].crTEXT+"; font-family: "+e[8].szFACENAME+"; font-weight: "+e[8].uWEIGHT+"; line-height: "+e[8].uHEIGHT+"; } ",s=(e[9]["RC.TOP"],".propPadding { padding: "+e[9]["RC.TOP"]+"px "+e[9]["RC.RIGHT"]+"px "+e[9]["RC.BOTTOM"]+"px "+e[9]["RC.LEFT"]+"px }"),c=t+i+o+n+l+r+d+s+a+s,p=document.createElement("style");p.type="text/css",p.innerHTML=c,document.body.appendChild(p)},w.gridShading=!0,w.wdGridLoader={shading:"gridShading",shadingColor:"rgba(256,256,256,0.9)",position:{of:"#gridContainer"},bindingOptions:{visible:"tableLoader"}},w.items={},C.temp_description="Description",C.temp_docid="Doc ID",C.temp_version="Ver#",C.temp_modified="Modified",C.temp_comment="Comments",C.temp_descrcomment="",C.temp_created="Created",C.temp_accessed="Accessed",C.temp_size="Size",C.temp_cabinet="Cabinet",C.temp_location="Location",C.temp_categories="Categories",C.temp_checkoutLabel=0,C.temp_checkoutValue=0,C.temp_name="Name",C.temp_status=0,C.lastVersionFile=0,C.versionlist=!1;var F=new DevExpress.data.CustomStore({key:["DocId","Version"],load:function(e){var t={},i="",o="";switch(w.sortFlag){case!1:u.typeid?"template"==u.typeid?(w.queryTitle="Template: "+u.temp,i="+wd_File_Xname_Filter="+u.xName+"+wd_File_Filename_Filter="+u.fName+"+wd_File_AccessDate_Filter="+u.access+"+wd_File_Created_Filter="+u.create+"+wd_File_Updated_Filter="+u.modified+"+wd_File_Text_Filter="+u.text+"+wd_File_ProfileGroup_Filter="+u.cabinet+"+wd_File_Field1_Filter="+u.field1+"+wd_File_Field2_Filter="+u.field2+"+wd_File_Field3_Filter="+u.field3+"+wd_File_Field4_Filter="+u.field4+"+wd_File_Field5_Filter="+u.field5+"+wd_File_Field6_Filter="+u.field6+"+wd_File_Field7_Filter="+u.field7,o="FINDFILES",C.versionlist=!1):"version"==u.typeid?(i="+wd_List_ID="+u.verid+"+Wd_List_RecNum="+u.verRec+"+Wd_File_Sort_Key1="+g.columnId.version,o="VERLIST",C.versionlist=!0):(i="+wd_List_RecNum="+u.recId+"+wd_List_ID="+u.listId+"+wd_List_Flags="+u.flagId+"+typeid="+u.typeid,o="TREEOPEN",C.versionlist=!1):(i="+wd_FIND_QUERY="+s,o="FINDFILES",C.versionlist=!1);break;default:o="SORTFILES",i="+wd_List_ID="+g.wdListID}e.sort&&(t.orderby=e.sort[0].selector,e.sort[0].desc&&(t.orderby+=" desc")),e.skip?t.skip=parseInt(e.skip)+1||0:t.skip=0,t.take=e.take||50;return n.get(g.host+"cgi-bin/wdwebcgi.exe?"+o+"+wd_SID="+g.userData.session+"+html=/api/filelist/fileList.json"+i+"+skip="+t.skip+"+take="+t.take+"+Wd_File_Sort_Key1="+w.columnID+"+wd_File_Sort_Dir1="+w.sortType+"+wduser="+g.userData.username.split("@")[0]+"+wdIdUn="+Date.now()).then(function(e){if(C.title=e.data.root.Header.wd_Desc_Loc,w.listCount=e.data.root.Header.List_Count,-1!=v.indexOf("Frowser")?C.pageTitle=e.data.root.Header.wd_Tab:C.pageTitle=e.data.root.Header.wd_Tab.split(":")[1],""!=e.data.root.Header.ErrorCount&&"1"==e.data.root.Header.List_Count){if(1!=e.data.root.items.length||-1==e.data.root.items[0].Description.indexOf("Too many files found ("))return w.listFailed=!0,w.gridMessage=e.data.root.Header.wd_Error_MSG,{data:[],totalCount:0};w.gridMessage=e.data.root.items[0].Description;var t=w.gridMessage.split(".")[0];return w.getDefaultTemplate(!1),w.$parent.templates=!0,DevExpress.ui.notify(t+" , please narrow down your search.","error",4e3),{data:[],totalCount:0}}if(""!=e.data.root.Header.ErrorCount&&"0"==e.data.root.Header.List_Count)return w.listFailed=!0,w.gridMessage="No data found!",{data:[],totalCount:0};if(""==e.data.root.items)return w.gridMessage="No data found!",{data:[],totalCount:e.data.root.Header.List_Count};var i=e.data.root.Header.wd_Groupings;if(g.wdListID=e.data.root.Header.List_ID,w.callFlag){switch(i){case"1":var o=$("#gridContainer").dxDataGrid("instance"),n=o.option("columns");n.push({dataField:"GT"}),o.option("columns",n),o.columnOption("GT","groupIndex",0)}w.callFlag=!1}for(var a=e.data.root.items.map(function(e){return e}),l=0;l<a.length;l++){if(C.lastVersionFile<a[l].Version&&(C.lastVersionFile=a[l].Version),""==a[l].AccessedDate)a[l].Accessed="";else{var r=new Date(parseInt(1e3*a[l].AccessedDate));a[l].Accessed=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()}if(""==a[l].DateCreated)a[l].Created="";else{r=new Date(parseInt(1e3*a[l].DateCreated));a[l].Created=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()}if(C.temp_description.length<String(a[l].Description).length&&(C.temp_description=String(a[l].Description)),C.temp_docid.length<String(a[l].DocId).length&&(C.temp_docid=String(a[l].DocId)),a[l].Version&&C.temp_version.length<String(a[l].Version).length&&(C.temp_version=String(a[l].Version)),a[l].Comments){var d;d=a[l].Comments.split("\r\n");for(var s=0;s<d.length;s++)C.temp_descrcomment.length<String(d[s]).length&&(C.temp_descrcomment=d[s]);a[l].firstLineComments=d[0],C.temp_comment.length<d[0].length&&(C.temp_comment=String(d[0]))}if(C.temp_size.length<String(a[l].Size).length&&(C.temp_size=String(a[l].Size)),C.temp_cabinet.length<String(a[l].Cabinet).length&&(C.temp_cabinet=String(a[l].Cabinet)),C.temp_location.length<String(a[l].Location).length&&(C.temp_location=String(a[l].Location)),C.temp_name.length<String(a[l].Name).length&&(C.temp_name=String(a[l].Name)),a[l].CAT_ID){for(var c="",p=0;p<a[l].CAT_ID.length;p++)c+=", "+String(a[l].CAT_ID[p].CD);C.temp_categories.length<c.length&&(C.temp_categories=c)}if(49==a[l].I||48==a[l].I){w.canvas_checkoutLabel=angular.element("#myCanvas_checkoutLabel"),w.ctx_checkoutLabel=w.canvas_checkoutLabel[0].getContext("2d"),void 0===w.fontStyle[7]?w.ctx_checkoutLabel.font="9pt Calibri":w.ctx_checkoutLabel.font=w.fontStyle[7].uPOINTSIZE+"pt "+w.fontStyle[7].szFACENAME;var u=String(a[l].CHKOUT_TO_PREF)+String(a[l].CHKOUT_ON_PREF);48==a[l].I&&(u+="Check-In    ");var m=w.ctx_checkoutLabel.measureText(u).width;m>C.temp_checkoutLabel&&(C.temp_checkoutLabel=m),w.canvas_checkoutValue=angular.element("#myCanvas_checkotuValue"),w.ctx_checkoutValue=w.canvas_checkoutValue[0].getContext("2d"),void 0===w.fontStyle[6]?w.ctx_checkoutValue.font="10pt Calibri":w.ctx_checkoutValue.font=w.fontStyle[6].uPOINTSIZE+"pt "+w.fontStyle[6].szFACENAME;var h=String(a[l].CHKOUT_TO_NAME)+String(a[l].CHKOUT_ON_DATE),f=w.ctx_checkoutValue.measureText(h).width;f>C.temp_checkoutValue&&(C.temp_checkoutValue=f)}49!=a[l].I&&48!=a[l].I&&0!=a[l].I&&"undefined"!=a[l].I&&(C.temp_status=1)}return w.items=a,w.selectedText="File: "+w.items[0].LN+"/"+w.listCount,-1==v.indexOf("Frowser")&&void 0!==g.currentFile&&(g.currentFile.LID=e.data.root.Header.List_ID,w.loadPreviewWhenStartup(a)),{data:a,totalCount:e.data.root.Header.List_Count}},function(e){return DevExpress.ui.notify("Server error time out!","error",4e3),a.reject("Data Loading Error")})}});function T(e,t,i){o={LN:t.LN,RN:t.RN,LID:t.LID,Status:t.I,DocId:t.DocId,tags:t.CAT_ID,Description:t.Description},"group"!==i.rowType&&w.$parent.wdView&&(w.$parent.dialogTitle="Preview",w.$parent.listOptions=[t],w.filePage(o))}function y(e){var t=$("#gridContainer").dxDataGrid("instance").getSelectedRowsData();w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],w.$parent.dialogTitle="Check-Out";for(var i=0;i<t.length;i++)w.checkOutput(t[i])}w.rowSetCate="",w.contextualMenu=function(n){if(w.rowSetCate=n,w.cat={publicCat:[],personalCat:[],folderCat:[]},w.selectedFile=n.row.data.LN,w.selectedText="File: "+w.selectedFile+"/"+w.listCount,"headerPanel"!==n.target&&"data"===n.row.rowType&&"Categories"!==n.column.caption)n.element="<h1>"+n.row.data.Description+"</h1>",n.items=c.getContextMenu(n);else if("headerPanel"!==n.target&&"data"===n.row.rowType&&"Categories"==n.column.caption){if(n.component.selectRows(n.row.key,!1),w.noDub=[],w.catResponse="",w.shareMenu=[{text:"Add Category",icon:"ms-Icon ms-Icon--Add",items:w.subAddCategory,onItemClick:function(e){console.log(e.component)}},{text:"Create/Edit Categories",icon:"ms-Icon ms-Icon--SaveAs",onItemClick:function(e){C.$broadcast("categoryList",{cats:w.catResponse,file:n.row.data,type:"dataGrid"}),w.$parent.openCats=!0}}],w.categoryMenu=w.shareMenu,c.getCategoryList(n.row.data.FilePath).then(function(e){w.catResponse=e.data.root,w.showCatType={};var o=[];if(""!==w.catResponse.Header.Error_Count)return DevExpress.ui.notify(w.catResponse.Header.Error_Msg,"error",4e3),!1;angular.forEach(w.catResponse.Items,function(t,e){switch(o.push(t.TAB_NAME),t.TAB_NAME){case"Public":var i={text:t.CD,icon:C.host+t.CI,onItemClick:function(e){w.setCategory(t,n,!1)}};w.cat.publicCat.push(i);break;case"Personal":i={text:t.CD,icon:C.host+t.CI,onItemClick:function(e){w.setCategory(t,n,!1)}};w.cat.personalCat.push(i);break;case"Folder":i={text:t.CD,icon:C.host+t.CI,onItemClick:function(e){w.setCategory(t,n,!1)}};w.cat.folderCat.push(i)}});var t=o.filter(function(e,t){return o.indexOf(e)==t});angular.forEach(t,function(e,t){w.setSubMenu=[],"Public"==e?w.setSubMenu=w.cat.publicCat:"Personal"==e&&(w.setSubMenu=w.cat.personalCat),"Folder"==e&&(w.setSubMenu=w.cat.folderCat),w.noDubKey={},w.noDubKey={text:e,items:w.setSubMenu},w.noDub.push(w.noDubKey)}),angular.forEach(n.items,function(e,t){"Add Category"==e.text&&(w.subAddCategory=w.noDub)})},function(e){}),""==n.row.data.CAT_ID)w.categoryMenu=w.shareMenu;else{w.categorylist=[];var i={};angular.forEach(n.row.data.CAT_ID,function(t,e){i={text:t.CD,icon:C.host+t.CI,items:[{text:"Remove",icon:"ms-Icon ms-Icon--Remove",onItemClick:function(e){w.setCategory(t,n,!0)}}]},w.categorylist.push(i)}),w.categoryMenu=w.categorylist.concat(w.shareMenu)}n.items=w.categoryMenu}},w.dataGridOptions={useKeyboard:!I,dataSource:{store:F},bindingOptions:{rowAlternationEnabled:!0,"pager.infoText":"selectedText","pager.showPageSizeSelector":"showPageSize","paging.pageSize":"pageSize"},allowColumnReordering:!0,columnChooser:{},scrolling:{showScrollbar:"always",useNative:!0,renderingThreshold:1e4},renderAsync:!0,columnFixing:{enabled:!0},loadPanel:{enabled:!0,shading:!0,shadingColor:"rgba(256,256,256,1.0)",showPane:!0},columnAutoWidth:!0,selection:{mode:"single",selectAllMode:"page"},remoteOperations:{sorting:!0,paging:!0},pager:{allowedPageSizes:[50,100,150,200,250],showInfo:!0,visible:!0,showNavigationButtons:!1},showColumnLines:!1,showRowLines:!0,rowAlternationEnabled:!1,showBorders:!0,hoverStateEnabled:!0,tabIndex:-1,allowColumnResizing:!0,calculateFilterExpression:function(e){console.log(e)},onInitialized:function(e){w.setFontData()},columns:[{dataField:"",cellTemplate:"downLoadFile",showInColumnChooser:!1,width:"22",allowSorting:!1,allowSearch:!0},{caption:"",dataField:"TypeStatus",cellTemplate:"fileSecurityIco",showInColumnChooser:!1,width:"25",name:"ico",allowSorting:!1,allowSearch:!0},{caption:"Description",dataField:"Description",cellTemplate:"cellTemplate",showInColumnChooser:!1,calculateCellValue:function(e){if(""!=e.DateUpdated){var t=new Date(parseInt(1e3*e.DateUpdated)),i=t.getHours(),o=t.getMinutes(),n=12<=i?"PM":"AM";i=(i%=12)||12,o=o<10?"0"+o:o,e.Modified=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+"  "+i+":"+o+" "+n}if(""!=e.Description)return e.Description;return"Blank Description"},filterOperations:[],selectedFilterOperation:"contains",allowFiltering:!0,minWidth:"80",width:w.widthDes,allowSearch:!0},{caption:"Doc ID",dataField:"DocId",filterOperations:[],selectedFilterOperation:"contains",minWidth:"60",width:w.widthDocID,calculateCellValue:function(e){return e.DocId},visible:-1<f.indexOf("Doc ID"),cellTemplate:function(e,t){e.append("<div class='topPadding'><div style='overflow: hidden; white-space: nowrap; text-overflow: ellipsis;' class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{dataField:"Ver#",calculateCellValue:function(e){return e.Version},cellTemplate:"versionCell",filterOperations:[],selectedFilterOperation:"contains",minWidth:"50",width:w.widthVer,visible:-1<f.indexOf("Ver #"),allowSearch:!0},{caption:"Modified",dataField:"DateUpdated",filterOperations:[],selectedFilterOperation:"contains",sortOrder:"desc",calculateCellValue:function(e){if(""==e.DateUpdated)return null;var t=new Date(parseInt(1e3*e.DateUpdated)),i=t.getHours(),o=t.getMinutes(),n=12<=i?"PM":"AM";return i=(i%=12)||12,o=o<10?"0"+o:o,t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()+"  "+i+":"+o+" "+n},minWidth:"70",width:w.widthModified,visible:-1<f.indexOf("Modified"),cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis;\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Comments",dataField:"comment",calculateCellValue:function(e){var t=e.firstLineComments;return t||""},filterOperations:[],selectedFilterOperation:"contains",minWidth:"70",width:w.widthDocID,visible:-1<f.indexOf("Comments"),cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis;\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Categories",dataField:"CD",cellTemplate:"wdTags",filterOperations:[],selectedFilterOperation:"contains",allowFiltering:!0,minWidth:"75",width:w.widthCategories,visible:-1<f.indexOf("Categories"),allowSearch:!0},{caption:"Created",dataField:"DateCreated",filterOperations:[],selectedFilterOperation:"contains",calculateCellValue:function(e){if(""==e.DateCreated)return null;var t=new Date(parseInt(1e3*e.DateCreated));return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},visible:-1<f.indexOf("Created"),minWidth:"70",width:w.widthCreated,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Accessed",dataField:"AccessedDate",filterOperations:[],selectedFilterOperation:"contains",calculateCellValue:function(e){if(""==e.AccessedDate)return null;var t=new Date(parseInt(1e3*e.AccessedDate));return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},visible:-1<f.indexOf("Accessed"),minWidth:"70",width:w.widthAccessed,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{dataField:"Size",filterOperations:[],selectedFilterOperation:"contains",minWidth:"50",calculateCellValue:function(e){return e.Size},width:w.widthSize,visible:-1<f.indexOf("Size"),cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{filterOperations:[],selectedFilterOperation:"contains",dataField:"Cabinet",calculateCellValue:function(e){return e.Cabinet},visible:-1<f.indexOf("Cabinet"),minWidth:"60",width:w.widthCabinet,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{filterOperations:[],selectedFilterOperation:"contains",dataField:"Location",calculateCellValue:function(e){return e.Location},visible:-1<f.indexOf("Location"),minWidth:"60",width:w.widthLocation,cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 1 Desc",dataField:"Field1Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 1 Desc"),headerCellTemplate:"Field1 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><divstyle=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 1 Code",dataField:"Field1",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 1 Code"),headerCellTemplate:"Field1 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 2 Desc",dataField:"Field2Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 2 Desc"),headerCellTemplate:"Field2 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 2 Code",dataField:"Field2",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 2 Code"),headerCellTemplate:"Field2 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 3 Desc",dataField:"Field3Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 3 Desc"),headerCellTemplate:"Field3 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 3 Code",dataField:"Field3",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 3 Code"),headerCellTemplate:"Field3 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 4 Desc",dataField:"Field4Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 4 Desc"),headerCellTemplate:"Field4 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 4 Code",dataField:"Field4",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 4 Code"),headerCellTemplate:"Field4 CodeT emplate",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 5 Desc",dataField:"Field5Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 5 Desc"),headerCellTemplate:"Field5 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 5 Code",dataField:"Field5",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 5 Code"),headerCellTemplate:"Field5 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 6 Desc",dataField:"Field6Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 6 Desc"),headerCellTemplate:"Field6 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 6 Code",dataField:"Field6",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 6 Code"),headerCellTemplate:"Field6 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 7 Desc",dataField:"Field7Desc",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 7 Desc"),headerCellTemplate:"Field7 Desc Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0},{caption:"Field 7 Code",dataField:"Field7",locateInMenu:"auto",filterOperations:[],selectedFilterOperation:"contains",minWidth:"100",visible:-1<f.indexOf("Field 7 Code"),headerCellTemplate:"Field7 Code Template",cellTemplate:function(e,t){e.append("<div class='topPadding'><div style=\"overflow: hidden; white-space: nowrap; text-overflow: ellipsis\" class='lineOne'>"+t.text+"</div></div>")},allowSearch:!0}],onContentReady:function(e){C.setTitleHeaderWidth();e.component.getView("columnChooserView");var t=document.getElementById("overlay");m=$("#gridContainer").dxDataGrid("instance"),$(".dx-freespace-row").css("height",1);var i=e.component;if(e.component.pageCount()<=1&&(w.showPagination=!1),0<m.totalCount()){w.cat={publicCat:[],personalCat:[],folderCat:[]},w.noDub=[],w.catResponse="";var a=m.getVisibleRows();void 0!==a&&0!==a.length&&c.getCategoryList(a[0].data.FilePath).then(function(e){w.catResponse=e.data.root,w.showCatType={};var n=[];if(""!==w.catResponse.Header.Error_Count)return DevExpress.ui.notify(w.catResponse.Header.Error_Msg,"error",4e3),!1;angular.forEach(w.catResponse.Items,function(i,e){switch(n.push(i.TAB_NAME),i.TAB_NAME){case"Public":var t={text:i.CD,icon:C.host+i.CI,onItemClick:function(e){w.setCategory(i,a[0],!1)}},o=0;angular.forEach(w.cat.publicCat,function(e,t){e.text==i.CD&&(o=1)}),0==o&&w.cat.publicCat.push(t);break;case"Personal":t={text:i.CD,icon:C.host+i.CI,onItemClick:function(e){w.setCategory(i,a[0],!1)}},o=0;angular.forEach(w.cat.personalCat,function(e,t){e.text==i.CD&&(o=1)}),0==o&&w.cat.personalCat.push(t);break;case"Folder":t={text:i.CD,icon:C.host+i.CI,onItemClick:function(e){w.setCategory(i,a[0],!1)}},o=0;angular.forEach(w.cat.folderCat,function(e,t){e.text==i.CD&&(o=1)}),0==o&&w.cat.folderCat.push(t)}});var t=n.filter(function(e,t){return n.indexOf(e)==t});angular.forEach(t,function(i,e){w.setSubMenu=[],"Public"==i?w.setSubMenu=w.cat.publicCat:"Personal"==i&&(w.setSubMenu=w.cat.personalCat),"Folder"==i&&(w.setSubMenu=w.cat.folderCat),w.noDubKey={},w.noDubKey={text:i,items:w.setSubMenu};var o=0;angular.forEach(w.noDub,function(e,t){e.text==i&&(o=1)}),0==o&&w.noDub.push(w.noDubKey)}),w.subAddCategory=w.noDub},function(e){})}w.columnarr=[],w.columnarr_item=[],w.columnarr_visivle=[],w.lastcolumn="";for(var o=0;o<i.columnCount();o++){var n=i.columnOption(o);1==n.showInColumnChooser&&(w.columnarr.push([n.caption,n.dataField]),w.columnarr_item.push(n.caption),1==n.visible&&(w.columnarr_visivle.push(n.caption),w.lastcolumn=n.caption))}if(1==C.temp_status?i.columnOption("TypeStatus","width",50):i.columnOption("TypeStatus","width",25),!g.ColumnsChooser){w.canvas=angular.element("#myCanvas"),w.ctx=w.canvas[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx.font="11pt Calibri":w.ctx.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp=C.temp_description;var l=0;l=50+C.temp_checkoutValue+C.temp_checkoutLabel<25+w.ctx.measureText(w.html_temp).width?20+w.ctx.measureText(w.html_temp).width:50+C.temp_checkoutValue+C.temp_checkoutLabel,w.canvas_docid=angular.element("#myCanvas_docid"),w.ctx_docid=w.canvas_docid[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_docid.font="11pt Calibri":w.ctx_docid.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_docid=C.temp_docid,i.columnOption("Doc ID","width",25+w.ctx_docid.measureText(w.html_temp_docid).width),w.widthDocID=25+w.ctx_docid.measureText(w.html_temp_docid).width,w.canvas_version=angular.element("#myCanvas_version"),w.ctx_version=w.canvas_version[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_version.font="11pt Calibri":w.ctx_version.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_version=C.temp_version,i.columnOption("Ver#","width",25+w.ctx_version.measureText(w.html_temp_version).width),w.widthVer=25+w.ctx_version.measureText(w.html_temp_version).width,w.canvas_modified=angular.element("#myCanvas_modified"),w.ctx_modified=w.canvas_modified[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_modified.font="11pt Calibri":w.ctx_modified.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_modified=angular.element(document).find("#myCanvas_modified")[0].innerHTML,i.columnOption("Modified","width",25+w.ctx_modified.measureText(w.html_temp_modified).width),w.widthModified=25+w.ctx_modified.measureText(w.html_temp_modified).width,w.canvas_categories=angular.element("#myCanvas_categories"),w.ctx_categories=w.canvas_categories[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_categories.font="11pt Calibri":w.ctx_categories.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_categories=C.temp_categories,i.columnOption("Categories","width",90+w.ctx_categories.measureText(w.html_temp_categories).width),w.widthCategories=90+w.ctx_categories.measureText(w.html_temp_categories).width,w.canvas_size=angular.element("#myCanvas_size"),w.ctx_size=w.canvas_size[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_size.font="11pt Calibri":w.ctx_size.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_size=C.temp_size,i.columnOption("Size","width",50+w.ctx_size.measureText(w.html_temp_size).width),w.widthSize=50+w.ctx_size.measureText(w.html_temp_size).width,w.canvas_comment=angular.element("#myCanvas_comment"),w.ctx_comment=w.canvas_comment[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_comment.font="11pt Calibri":w.ctx_comment.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_comment=C.temp_comment,i.columnOption("Comments","width",25+w.ctx_comment.measureText(w.html_temp_comment).width),w.ctx_descomment=w.canvas_comment[0].getContext("2d"),void 0===w.fontStyle[1]?w.ctx_descomment.font="12pt Calibri":w.ctx_descomment.font=w.fontStyle[1].uPOINTSIZE+"pt "+w.fontStyle[1].szFACENAME,l<50+w.ctx_descomment.measureText(C.temp_descrcomment).width&&(l=50+w.ctx_descomment.measureText(C.temp_descrcomment).width),w.canvas_propLabel=angular.element("#myCanvas_propLabel"),w.ctx_propLabel=w.canvas_propLabel[0].getContext("2d"),void 0===w.fontStyle[9]?w.ctx_propLabel.font="10pt Calibri":w.ctx_propLabel.font=w.fontStyle[9].uPOINTSIZE+"pt "+w.fontStyle[9].szFACENAME,w.canvas_propValue=angular.element("#myCanvas_propValue"),w.ctx_propValue=w.canvas_propValue[0].getContext("2d"),void 0===w.fontStyle[8]?w.ctx_propValue.font="10pt Calibri":w.ctx_propValue.font=w.fontStyle[8].uPOINTSIZE+"pt "+w.fontStyle[8].szFACENAME;var r="",d="";switch(w.showVersion&&(r+="Version #",d+=C.temp_version),w.showDocID&&(r+="Doc ID: ",d+=C.temp_docid),w.showModified&&(r+="Modified: ",d+=w.html_temp_modified),w.showSize&&(r+="Size: ",d+=C.temp_size),w.showCreated&&(r+="Created: ",d+=angular.element(document).find("#myCanvas_created")[0].innerHTML),w.showAccessed&&(r+="Accessed: ",d+=angular.element(document).find("#myCanvas_created")[0].innerHTML),l<50+w.ctx_propLabel.measureText(r).width+w.ctx_propValue.measureText(d).width&&(l=50+w.ctx_propLabel.measureText(r).width+w.ctx_propValue.measureText(d).width),i.columnOption("Description","width",l),w.canvas_cabinet=angular.element("#myCanvas_cabinet"),w.ctx_cabinet=w.canvas_cabinet[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_cabinet.font="11pt Calibri":w.ctx_cabinet.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_cabinet=C.temp_cabinet,i.columnOption("Cabinet","width",25+w.ctx_cabinet.measureText(w.html_temp_cabinet).width),w.widthCabinet=25+w.ctx_cabinet.measureText(w.html_temp_cabinet).width,w.canvas_location=angular.element("#myCanvas_location"),w.ctx_location=w.canvas_comment[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_location.font="11pt Calibri":w.ctx_location.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_location=C.temp_location,i.columnOption("Location","width",25+w.ctx_location.measureText(w.html_temp_location).width),w.widthLocation=25+w.ctx_location.measureText(w.html_temp_location).width,w.canvas_created=angular.element("#myCanvas_created"),w.ctx_created=w.canvas_created[0].getContext("2d"),void 0===w.fontStyle[10]?w.ctx_created.font="11pt Calibri":w.ctx_created.font=w.fontStyle[10].uPOINTSIZE+"pt "+w.fontStyle[10].szFACENAME,w.html_temp_created=angular.element(document).find("#myCanvas_created")[0].innerHTML,i.columnOption("Created","width",25+w.ctx_created.measureText(w.html_temp_created).width),i.columnOption("Accessed","width",25+w.ctx_created.measureText(w.html_temp_created).width),w.widthCreated=25+w.ctx_created.measureText(w.html_temp_created).width,w.widthAccessed=25+w.ctx_created.measureText(w.html_temp_created).width,w.lastcolumn){case"Doc ID":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_docid.measureText(w.html_temp_docid).width),w.widthDocID="70%";break;case"Ver#":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_version.measureText(w.html_temp_version).width),w.widthVer="70%";break;case"Modified":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_modified.measureText(w.html_temp_modified).width),w.widthModified="70%";break;case"Categories":i.columnOption(w.lastcolumn,"minWidth",50+w.ctx_categories.measureText(w.html_temp_categories).width),w.widthCategories="70%";break;case"Size":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_size.measureText(w.html_temp_size).width),w.widthSize="70%";break;case"Comments":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_comment.measureText(w.html_temp_comment).width);break;case"Cabinet":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_cabinet.measureText(w.html_temp_cabinet).width),w.widthCabinet="70%";break;case"Location":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_location.measureText(w.html_temp_location).width),w.widthLocation="70%";break;case"Created":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_created.measureText(w.html_temp_created).width),w.widthCreated="70%";break;case"Accessed":i.columnOption(w.lastcolumn,"minWidth",10+w.ctx_created.measureText(w.html_temp_created).width),w.widthAccessed="70%"}i.columnOption(w.lastcolumn,"width","70%")}if(w.deleteType="toggle",w.scrollBtm="ScrollBottom",w.allowEditing=!1,w.selectedItems=w.columnarr_visivle,w.listOptions_clm_cbx={dataSource:w.columnarr_item.sort(),editEnabled:!0,height:187,showSelectionControls:!0,selectionMode:"multiple",pageLoadMode:"scrollBtm",bindingOptions:{allowItemDeleting:"allowEditing",itemDeleteMode:"deleteType",selectedItems:"selectedItems"}},w.indicateWidth=e.element.width(),w.indicateHeight=e.element.height(),w.gridData=e,!g.isOpeningDocPanel&&0<e.component.totalCount()&&-1==w.gridMessage.indexOf("Too many files found (")){var s;e.component.selectRowsByIndexes(0),s=e.component.getSelectedRowsData(),w.setToolbarStatus(s[0]),w.loadHeader(s[0])}$(".dx-freespace-row").css("height",1),setTimeout(function(){var e=$("#leftNav").width();$("#gridContainer").css("max-width",parseInt(parseInt($(window).width())-parseInt(e))+"px")},-1),w.listCount>w.pageSize&&(w.showPageSize=!0),$("#gridContainer").mouseover(function(e){C.checkOverGrid=!0}),$("#gridContainer").mouseout(function(e){C.checkOverGrid=!1}),p(function(){t.classList.add("loaded"),w.tableLoader=!1},-1e3)},onRowPrepared:function(e){"data"==e.rowType&&e.rowElement.attr({id:"ln"+e.data.LN})},onToolbarPreparing:function(e){e.toolbarOptions.items.unshift({location:"before",template:"queryTitle"}),e.toolbarOptions.items.unshift({location:"after",template:"wdGridFilter",width:w.widthFit}),e.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"ms-Icon ms-Icon--Settings",text:"",onClick:function(e){w.isPopupVisible=!0},elementAttr:{id:"btnCustomize"}}})},onRowClick:function(e){var t=e.component;t.getSelectedRowKeys().length,t.lastClickTime;o={LN:e.data.LN,RN:e.data.RN,LID:e.data.LID,Status:e.data.I,DocId:e.data.DocId,tags:e.data.CAT_ID,Description:e.data.Description,profileGroupId:e.data.profileGroupId,Extension:e.data.Extension,FilePath:e.data.FilePath,ver:e.data.version},t.lastClickTime=new Date,D&&x===e.rowIndex?(D=null,x=e.rowIndex,void 0!==e.data.Version&&null==u.verid?(w.$parent.dialogTitle=w.dwnTxt,w.$parent.userType="version",w.$parent.errorTypeDialog="user",w.$parent.fileError=!0,w.$parent.wdDocId=e.data.DocId,w.$parent.wdDesc=e.data.Description,w.$parent.changeDialogOption=!0):w.download(o)):(D=!0,setTimeout(function(){D=!1},250),w.selectedFile=e.data.LN,w.selectedText="File: "+w.selectedFile+"/"+w.listCount,w.loadHeader(e.data),T(e.component,e.data,e)),w.setToolbarStatus(e.data),v.indexOf("Frowser"),x=e.rowIndex},onContextMenuPreparing:w.contextualMenu,height:function(){return w.getHeight(!0)},onCellClick:function(e){var t=e.component.getSelectedRowKeys().length;if(w.selectedRow=t,w.selectedFiles=e.component.getSelectedRowsData(),"header"===e.rowType&&void 0!==e.column.dataType){var i;switch(w.sortFlag=!0,e.column.caption){case"Description":i=void 0,w.columnID=g.columnId.desc;break;case"Categories":i=void 0,w.columnID=g.columnId.category;break;case"Ver #":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.version;break;case"Doc ID":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.docid;break;case"Created":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.create;break;case"Updated":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.update;break;case"Accessed":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.access;break;case"Location":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.location;break;case"Size":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.size;break;case"Cabinet":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.cabinet;break;case"Field 1 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field1;break;case"Field 1 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field1Desc;break;case"Field 2 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field2;break;case"Field 2 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field2Desc;break;case"Field 3 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field3;break;case"Field 3 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field3Desc;break;case"Field 4 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field4;break;case"Field 4 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field4Desc;break;case"Field 5 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field4;break;case"Field 5 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field5Desc;break;case"Field 6 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field6;break;case"Field 6 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field6Desc;break;case"Field 7 Code":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field7;break;case"Field 7 Desc":i=e.cellElement[0].children[1].lastChild.classList[1],w.columnID=g.columnId.field7Desc;break;case void 0:break;default:console.log("blank")}switch(i){case"dx-sort-none":case"dx-sort-down":w.sortType=0;break;case void 0:h&&(w.sortType=1),h||(w.sortType=0),h=!h;break;default:w.sortType=1}e.component.refresh()}if("boolean"===e.column.dataType){t=e.component.getSelectedRowKeys().length;w.selectedRow=e.component.getSelectedRowKeys().length,T(e.component,e.component.getSelectedRowsData().pop(),e)}},selectedRowKeys:void 0!==g.currentFile?g.currentFile.DocId:[],onKeyDown:function(e){var t=e.component.getSelectedRowKeys();if(t.length){var i=t[0],o=e.component.getRowIndexByKey(i);39!==e.event.keyCode&&37!==e.event.keyCode||e.event.preventDefault(),38===e.event.keyCode?1<e.component.getSelectedRowKeys().length?e.event.preventDefault():0<=--o&&e.component.selectRowsByIndexes([o]):40===e.event.keyCode&&(1<e.component.getSelectedRowKeys().length?e.event.preventDefault():(o++,e.component.getDataSource().items().length===o?o=o:(e.component.selectRowsByIndexes([o]),e.event.stopPropagation()))),!w.$parent.wdView||38!==e.event.keyCode&&40!==e.event.keyCode||T(e.component,e.component.getSelectedRowsData().pop(),e)}},customizeColumns:function(e){for(var t=$("#gridContainer").dxDataGrid("instance"),i=0;i<t.columnCount();i++){t.columnOption(i);g.ColumnsIndex?e[i].visibleIndex=g.ColumnsIndex[i]:e[i].visibleIndex=i}},onColumnsChanging:function(e){var t=$("#gridContainer").dxDataGrid("instance");w.maxWidthDesc<t.columnOption("Description","width")?(t.columnOption("Description","width",w.maxWidthDesc),t.columnOption("Doc ID","width",w.widthDocID),t.columnOption("Ver#","width",w.widthVer),t.columnOption("Modified","width",w.widthModified),t.columnOption("Categories","width",w.widthCategories),t.columnOption("Created","width",w.widthCreated),t.columnOption("Accessed","width",w.widthAccessed),t.columnOption("Size","width",w.widthSize),t.columnOption("Cabinet","width",w.widthCabinet),t.columnOption("Location","width",w.widthLocation)):(w.widthDocID=t.columnOption("Doc ID","width"),w.widthVer=t.columnOption("Ver#","width"),w.widthModified=t.columnOption("Modified","width"),w.widthCategories=t.columnOption("Categories","width"),w.widthCreated=t.columnOption("Created","width"),w.widthAccessed=t.columnOption("Accessed","width"),w.widthSize=t.columnOption("Size","width"),w.widthCabinet=t.columnOption("Cabinet","width"),w.widthLocation=t.columnOption("Location","width")),g.MarkFavView&&w.saveFavView()}},w.displayComments=function(){w.showComments=!w.showComments,w.showComments?w.fontSectionLabel="Hide File List Comments":w.fontSectionLabel="Display File List Comments"},w.showColumnChooser=function(){var l=$(".popup-columnChooser").dxPopup("instance");l.option("position",{my:"right",at:"bottom",of:C.parentColumnChoose}),l.show();var e=$("#gridContainer").dxDataGrid("instance");w.columnarr=[],w.columnarr_item=[];for(var t=0;t<e.columnCount();t++){var i=e.columnOption(t);1==i.showInColumnChooser&&(w.columnarr.push([i.caption,i.dataField]),w.columnarr_item.push(i.caption))}setTimeout(function(){if($(".dx-overlay-wrapper.popup.popup-columnChooser").find(".dx-toolbar-after").html('<div class="dx-item dx-toolbar-item dx-toolbar-button"><div class="dx-item-content dx-toolbar-item-content"><div class="dx-closebutton dx-button dx-button-normal dx-widget dx-button-has-icon" role="button" aria-label="close" tabindex="0"><div class="dx-button-content"><i class="dx-icon dx-icon-close"></i></div></div></div></div>'),$(document).on("click",".dx-closebutton",function(){l.hide()}),$("#dxlist-clm_cbx").dxList("instance").reload(),0<w.columnarr_visivle.length)for(var e=0;e<w.columnarr_visivle.length;e++)$("#dxlist-clm_cbx").dxList("instance").selectItem(w.columnarr_visivle[e]);var i,t=$("#gridContainer").dxDataGrid("instance");w.columnarr=[],w.columnarr_item=[];for(e=0;e<t.columnCount();e++){var o=t.columnOption(e);1==o.showInColumnChooser&&(w.columnarr.push([o.caption,o.dataField]),w.columnarr_item.push(o.caption))}$(document).on("click",".btn-apply-clm-chooser",function(){l.hide();for(var e=$("#hdd-selecteditem").val().split(", "),t=0;t<w.columnarr.length;t++){for(var i=w.columnarr[t],o=0,n=0;n<13;n++)i[0]==e[n]&&(o=1);var a=$("#gridContainer").dxDataGrid("instance");1==o?a.columnOption(i[1],"visible",!0):a.columnOption(i[1],"visible",!1),a.refresh()}-1!=e.indexOf("Ver #")?w.showVersion=!1:w.markVersion&&(w.showVersion=!0),-1!=e.indexOf("Modified")?w.showModified=!1:w.markModified&&(w.showModified=!0),-1!=e.indexOf("Size")?w.showSize=!1:w.markSize&&(w.showSize=!0),-1!=e.indexOf("Created")?w.showCreated=!1:w.markCreated&&(w.showCreated=!0),-1!=e.indexOf("Accessed")?w.showAccessed=!1:w.markAccessed&&(w.showAccessed=!0),-1!=e.indexOf("Doc ID")?w.showDocID=!1:w.markDocId&&(w.showDocID=!0),g.MarkFavView&&w.saveFavView()}),w.buttonOptionsApplyChooser={text:"Apply",height:30,width:120,type:"success",template:function(e,t){$("<div class='button-indicator'></div><span class='dx-button-text'>"+e.text+"</span>").appendTo(t),i=t.find(".button-indicator").dxLoadIndicator({visible:!1,width:16,height:16}).dxLoadIndicator("instance")},onClick:function(e){e.component.option("text","Applying"),i.option("visible",!0),setTimeout(function(){w.applyColumnChooserPopUp(),l.hide(),i.option("visible",!1),e.component.option("text","Apply")},-1)}}},100)},w.$on("eventFired",function(e,t){if("download"==t.type)return w.download(t.file.data),!1;T(w.gridData.component,w.gridData.component.getSelectedRowsData().pop(),w.gridData)}),-1!=v.indexOf("Frowser")?u.attach?(w.dwnIco="ms-Icon ms-Icon--Attach",w.dwnTxt="Attach"):(w.dwnIco="ms-Icon ms-Icon--OpenFile",w.dwnTxt="Open"):(w.dwnIco="ms-Icon ms-Icon--Download",w.dwnTxt="Download"),u.attach&&(w.attach=!0),w.setAttachPop=function(){w.$parent.visiblePopup=!0},w.gridHeader={f1code:"",f1desc:"",f1name:""},w.callFlag=!0,angular.element(r).bind("resize",function(){var e=$("#leftNav").dxResizable("instance").option("width");if(w.wdView){var t=parseInt($("#leftNav").dxResizable("instance").option("width")),i=parseInt(window.innerWidth)-parseInt(t),o=i-parseInt($("#homeFileMenu").css("width"));$("#appBody").css("width",i).css("maxWidth",i),$("#homedataGrid, #gridContainer").css("width",o).css("maxWidth",o)}else $("#appBody, #homedataGrid, #gridContainer").css("width",window.innerWidth-e).css("max-width",window.innerWidth-e);$("#gridContainer").dxDataGrid("instance").option("height",window.innerHeight-145),$(".dx-freespace-row").css("height",1),$("#scrollWk").dxScrollView("instance").option("height",window.innerHeight-150),$("#scrollCab, #fmContainer").dxScrollView("instance").option("height",window.innerHeight-190),$("#dxVerList").dxList("height",window.innerHeight-190),$("#scrollPreview").dxScrollView("instance").option("height",window.innerHeight-165),setTimeout(function(){$("#listTitle").css({"max-width":"0px",width:"0px"}),$("#gridContainer").dxDataGrid("instance")._windowResizeCallBack(),C.setTitleHeaderWidth()},-1)}),C.$watch("wdStatus",function(e,t){if(e!=t)for(var i=0;i<w.items.length;i++)if(w.items[i].RN==C.rec&&"48"==w.items[i].I){if(w.items[i].I="0","1"==C.checkType){var o=parseInt(w.items[i].Version)+1;w.items[i].Version=o}}else w.items[i].RN==C.rec&&"0"==w.items[i].I&&(w.items[i].I="48")}),w.fileActionToolbar={adaptivityEnabled:!0,bindingOptions:{deep:!0,dataSource:"toolBarData"},onContentReady:function(e){setTimeout(function(){e.component._windowResizeCallBack()},4e3)}},w.chkStatus=function(e){var t;"49"===e.I?t="File isn't checkout to you":"52"===e.I&&(t="You do not need to check it in"),w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],w.$parent.dialogTitle="Check-In";var i={title:e.DocId,desc:e.Description,wdMsg:t};w.$parent.fileErrorMessage.push(i),w.$parent.genericError=!1,w.$parent.errorTypeDialog="action",w.$parent.fileError=!0},w.toolBarData=[{location:"before",widget:"dxButton",locateInMenu:"auto",options:{bindingOptions:{icon:"dwnIco",text:"dwnTxt"},elementAttr:{id:"wdOpenFile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance"),i=t.getSelectedRowsData();t.selectRows({DocId:i.pop().DocId},!1),w.download(t.getSelectedRowsData()[0])}}},{location:"before",widget:"dxButton",options:{icon:"ms-Icon ms-Icon--PageCheckedOut",text:"Check-Out",elementAttr:{id:"wdChkOut"},onClick:function(e){y(e)}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--Edit",text:"Edit Profile",elementAttr:{id:"wdEditProfile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance");if(0==t.getSelectedRowsData().length)return DevExpress.ui.notify("Please select a file!","error"),!1;c.getDataGridControlerScope(e);var i={row:{data:t.getSelectedRowsData().pop()}};l.setSelected(t.getSelectedRowsData()),c.openPanel(i,e,0,"Profile","toolbar"),e.model.$parent.$parent.checked=!0,C.$broadcast("editIcon",{flag:"Edit"})}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--Copy",text:"Copy",elementAttr:{id:"wdCopyProfile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance");if(0==t.getSelectedRowsData().length)return DevExpress.ui.notify("Please select a file!","error"),!1;c.getDataGridControlerScope(e);var i={row:{data:t.getSelectedRowsData().pop()}};l.setSelected(t.getSelectedRowsData()),c.openPanel(i,e,0,"Profile","toolbar"),e.model.$parent.$parent.checked=!0,C.$broadcast("editIcon",{flag:"Copy"})}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--Mail",text:"Email",elementAttr:{id:"wdEmail"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance");if(0==t.getSelectedRowsData().length)return DevExpress.ui.notify("Please select a file!","error"),!1;c.getDataGridControlerScope(e);var i={row:{data:t.getSelectedRowsData()[0]}};l.setSelected(t.getSelectedRowsData()),c.openPanel(i,e,1,"Email","toolbar"),w.$parent.dialogTitle="Email",e.model.$parent.$parent.checked=!0,"54"==t.getSelectedRowsData()[0].I?$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!0:$("#tabPanelItems").dxTabPanel("instance").option("dataSource")[0].disabled=!1}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"ms-Icon ms-Icon--EntryView",text:"View",elementAttr:{id:"wdViewFile"},onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance"),i={row:{data:t.getSelectedRowsData().pop()}};c.getDataGridControlerScope(e);e.model.$parent.$parent.wdView=!0,c.openPanel(i,e,0,"Preview","toolbar"),T(w.gridData.component,w.gridData.component.getSelectedRowsData().pop(),w.gridData),setTimeout(function(){$("#listTitle").css({"max-width":"0px",width:"0px"}),t._windowResizeCallBack(),C.setTitleHeaderWidth()},-1)}}},{location:"before",widget:"dxButton",options:{icon:"ms-Icon ms-Icon--Refresh",text:"Refresh",onClick:function(e){$("#gridContainer").dxDataGrid("instance").refresh()}}}],w.fieldContainer={Field1:!1,Field2:!1,Field3:!1,Field4:!1,Field5:!1,Field6:!1,Field7:!1},w.emailData={},w.setVersion=function(i){d.isFileHasChanged().then(function(e){if(e)C.$broadcast("showMessageWhenFileChanged"),setTimeout(function(){$("#btnConfirmCheckFile").on("click",function(e){e.preventDefault(),$("#popupFileChangedOptions").dxPopup().dxPopup("instance").hide();var t="";u.attach&&u.noEdit&&(t="&attach=1&noEdit=1"),r.open("./home?verid="+i.LID+"&verRec="+i.RN+"&typeid=version"+t,"_blank")})},200);else{var t="";u.attach&&u.noEdit&&(t="&attach=1&noEdit=1"),r.open("./home?verid="+i.LID+"&verRec="+i.RN+"&typeid=version"+t,"_blank")}})},w.setCategory=function(e,i,t){""!=w.rowSetCate&&(i=w.rowSetCate),d.addRemoveCat(e,i.row.data,t).then(function(e){var t=e.data.category;if(""!==t.errorStatus.ErrorCount)return DevExpress.ui.notify(t.errorStatus.wd_Error_MSG,"error",4e3),!1;i.component.refresh()},function(e){i.component.refresh()})},w.getHeight=function(e){if(e)return window.innerHeight-145;p(function(){$("#gridContainer").height(window.innerHeight-145)},0)},w.getWidth=function(){setTimeout(function(){return window.innerWidth-$("#leftNav").width()},-1)},w.setFavorite=function(e,t,i,o){d.setFields(e,t,i,o).then(function(e){var t=e.data;if(""!=t.setField.errorStatus.ErrorCount)return DevExpress.ui.notify(t.setField.errorStatus.wd_Error_MSG,"error",4e3),!1;switch(o.FF){case"2147483725":case"11907":case"11501":case"11303":case"11301":case"1":o.FF="0";break;default:o.FF="2147483725"}},function(e){DevExpress.ui.notify("Server Error","error",4e3)})},w.checkin={uploadUrl:g.host+g.uploadLocation,bindingOptions:{multiple:"multiple",accept:"accept",value:"value",uploadMode:"uploadMode"},visible:!1,onUploadError:function(e){DevExpress.ui.notify("Upload failed! "+e.request.statusText,"error",4e3)},onUploaded:function(e){if("N"==C.checkinType)return w.uploadToWldox("1",e.file.name),!1;w.uploadToWldox("",e.file.name)},onUploadStarted:function(e){var t=$("#gridContainer").dxDataGrid("instance").getSelectedRowsData()[0].LN;$("#wdDesc"+t).dxLoadIndicator("instance").option("visible",!0)}},w.setDescLoaderId=function(e){return"wdDesc"+e.LN},w.descLoader={height:16,width:16,visible:!1},w.uploadToWldox=function(i,o){var e=m.getSelectedRowsData(),n={RN:e[0].RN,LID:e[0].LID,LN:e[0].LN};d.uploadToWorldox(i,n,o).then(function(e){var t=e.data.uploadVerb;if(""!=t.errorStatus.ErrorCount)return DevExpress.ui.notify(t.errorStatus.wd_Error_MSG,"error",4e3),!1;w.checkToWdx(n,o,i)},function(e){DevExpress.ui.notify("IIS Error","error",4e3)})},w.checkToWdx=function(i,e,o){var n=m.getSelectedRowsData(),a=$("#gridContainer").dxDataGrid("instance");d.chkToWorldox(i,e).then(function(e){if(w.$parent.fileSuccessMessage=[],w.$parent.fileErrorMessage=[],""!=e.data.fileStatus.errorStatus.ErrorCount){var t={title:n[0].DocId,desc:n[0].Description,wdMsg:"File checked-in successfully"};return w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,a.refresh(),!1}C.rec=i.RN,C.wdStatus=Math.round(new Date/1e3),C.checkType=o,n[0].I="0";t={title:n[0].DocId,desc:n[0].Description,wdMsg:"File checked-in successfully"};w.$parent.fileSuccessMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,a.refresh()},function(e){DevExpress.ui.notify("IIS Error","error",4e3)})},w.getTypeLogo=function(e){switch(e){case"DOCX":case"DOC":case"DOTX":case"ODT":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--word'></div>";case"CSV":case"ODS":case"XLS":case"XLSX":case"XLTX":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--excel'></div>";case"MSG":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--outlook'></div>";case"ODP":case"POTX":case"PPSX":case"PPTX":case"ODP":case"POT":case"PPS":case"PPT":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--powerpoint'></div>";case"PDF":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--pdf'></div>";case"JPG":case"PNG":case"GIF":case"JPEG":case"TIFF":return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--image'></div>";default:return"<div class='ms-BrandIcon--icon16 ms-BrandIcon--filler'></div>"}},w.getIconTitle=function(e){switch(e.I){case"49":return"";case"51":return"Hidden by you";case"52":return"File Secured by:"+e.OW;case"53":return"";case"54":return"Read only access";case"55":return"";case"56":return"Your a Manager with access"}},w.getStatusIcon=function(e){switch(e){case"49":return"dx-icon ms-Icon ms-Icon--nothing";case"51":return"dx-icon ms-Icon ms-Icon--UnlockSolid statusGreen";case"52":return"dx-icon ms-Icon ms-Icon--LockSolid statusGreen";case"53":case"54":return"dx-icon ms-Icon ms-Icon--LockSolid statusYellow";case"55":case"56":return"dx-icon ms-Icon ms-Icon--LockSolid statusRed"}},w.getTilt=function(e){return decodeURI(e)},w.editFields={field1:"",field2:"",field3:"",field4:"",field5:"",field6:"",field7:"",placeholder1:"",placeholder2:"",placeholder3:"",placeholder4:"",placeholder5:"",placeholder6:"",placeholder7:"",description:"",comment:"",placeholderCo:"Comments",placeholderDesc:"Description"},w.setCatToolTip=function(e){return{target:"#toolTip"+e,showEvent:"dxhoverstart",hideEvent:"dxhoverend"}},w.setTipID=function(e,t){return t?"toolTip"+e:"tipId"+e},w.getContextual=function(e){$(".hoverMore").on("dxclick",function(e){var t=$.extend({},e,{type:"dxcontextmenu"});$(this).trigger(t)})},w.loadOpen={shadingColor:"rgba(256,256,256,0.2)",position:{of:window},bindingOptions:{visible:"loadingVisible"}},w.download=function(l,e){w.dwnSpinner=!1,w.loadingVisible=!0,w.$parent.fileSuccessMessage=[],w.$parent.fileErrorMessage=[],w.$parent.dialogTitle="Download",d.download(l).then(function(o){var e=o.data.download;if(""!=e.errorStatus.ErrorCount){var t={title:l.DocId,desc:l.Description,wdMsg:e.errorStatus.wd_Error_MSG};w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(e.message){t={title:l.DocId,desc:l.Description,wdMsg:e.message};w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(-1!=v.indexOf("Frowser"))w.$parent.dialogTitle=w.dwnTxt,d.getFolderLevel().then(function(e){for(var t=0;t<e.data.root.Cabinets.length;t++){var i=e.data.root.Cabinets[t].pgFields.split("|");if(e.data.root.Cabinets[t].pgID==l.profileGroupId&&"54"!==l.I)return w.checkAttachment(l,o.data,i),!1;e.data.root.Cabinets[t].pgID==l.profileGroupId&&"54"==l.I&&(w.$parent.userType="readOnly",w.$parent.errorTypeDialog="user",w.$parent.fileError=!0,w.$parent.wdDocId=l.DocId,w.$parent.wdDesc=l.Description,w.$parent.wdErr="The file is READ-ONLY (per it's security settings).",w.$parent.wdQuestion="Open a Read-ONLY copy?",w.saveReadOnlyData={fileData:o.data,resData:l,folderData:i})}},function(e){$log.error(e),DevExpress.ui.notify("IIS error 500","error",4e3)});else{if("PDF"===l.Extension)return w.dwnSpinner=!0,w.loadingVisible=!1,r.open(g.host+o.data.download.fileLoc,"_blank"),!1;if("WDL"===l.Extension){w.dwnSpinner=!0,w.loadingVisible=!1;var i=decodeURIComponent(l.FilePath+"\\"+l.DocId),n=encodeURIComponent(i);return r.open("./home?query=Project: "+encodeURIComponent(n),"_blank"),!1}var a={title:l.DocId,desc:l.Description,wdMsg:"File downloaded Succesfully"};w.$parent.fileSuccessMessage.push(a),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,r.location.href=g.host+o.data.download.fileLoc}w.dwnSpinner=!0,w.loadingVisible=!1},function(e){w.dwnSpinner=!0,w.loadingVisible=!1,DevExpress.ui.notify("IIS error 500","error",4e3)})},w.checkAttachment=function(e,t,i){if(u.noEdit)return w.saveReadOnlyData={fileData:t,resData:e,folderData:i},w.getResponse(w.saveReadOnlyData.fileData,w.saveReadOnlyData.resData,w.saveReadOnlyData.folderData),!1;w.checkedOut(e,t,i)},w.getCatList=function(e){var t=document.createElement("ul");t.classList.add("tipList");for(var i=0;i<e.CAT_ID.length;i++){var o=document.createElement("li");o.innerHTML="<img src='"+C.host+e.CAT_ID[i].CI+"' width='8' height='8' /> "+e.CAT_ID[i].CD,t.appendChild(o)}return t.outerHTML},w.checkedOut=function(t,i,o){if("WDL"===t.Extension){w.dwnSpinner=!0,w.loadingVisible=!1,w.dwnloadSpinner=!0;var e=decodeURIComponent(t.FilePath+"\\"+t.DocId),n=encodeURIComponent(e);return r.open("./home?query=Project: "+encodeURIComponent(n),"_blank"),!1}d.checkout(t).then(function(e){if("The file already checked-out to someone else"==e.data.fileStatus.errorStatus.wd_Error_MSG||"Unsufficient file rights"==e.data.fileStatus.errorStatus.wd_Error_MSG||"The file is already checked-out to you"==e.data.fileStatus.errorStatus.wd_Error_MSG||""==e.data.fileStatus.errorStatus.ErrorCount)return w.getResponse(i,t,o),!1;DevExpress.ui.notify(e.data.fileStatus.errorStatus.wd_Error_MSG,"error",4e3)},function(e){$log.log(e)})},w.getResponse=function(e,t,i){var o=0,n=e.download.FileZMS.replace(/\\/g,"\\\\"),a=$("#gridContainer").dxDataGrid("instance").getSelectedRowsData()[0];i.shift();for(var l=0;l<i.length;l++)""!==i[l]?i[l]=a["Field"+(l+1)]:i[l]="";w.$parent.fileError=!1,("54"==a.I||"49"==a.I||u.noEdit)&&(o=1),p(function(){r.location=g.host+"/cgi-bin/wdwebcgi.exe?SERVE+wd_SID="+g.userData.session+"+html=/api/apiList.json+dwLoc="+e.download.fileLoc+"+name="+e.download.FileNme+"+domain="+g.host+"+cabinet="+t.profileGroupId+"+f1="+i[0]+"+f2="+i[1]+"+f3="+i[2]+"+f4="+i[3]+"+f5="+i[4]+"+f6="+i[5]+"+f7="+i[6]+"+popFlag="+w.softpopFlag+"+zms="+n+"+readOnly="+o,w.updateList(a),w.dwnloadSpinner=!0},-1e3)},w.updateList=function(t){d.getFileProfile(t).then(function(e){t.I="48",t.CHKOUT_TO_PREF=e.data.file.CTOP,t.CHKOUT_TO_NAME=e.data.file.CTON,t.CHKOUT_ON_PREF=e.data.file.CONP,t.CHKOUT_ON_DATE=e.data.file.COND},function(e){console.log(e)})},w.loadHeader=function(e){w.gridHeader={f1code:void 0!==e?e.Field1:"",f1desc:void 0!==e?e.Field1Desc:"",f1name:void 0!==e?e.Field1Name:"",f2code:void 0!==e?e.Field2:"",f2desc:void 0!==e?e.Field2Desc:"",f2name:void 0!==e?e.Field2Name:"",f3code:void 0!==e?e.Field3:"",f3desc:void 0!==e?e.Field3Desc:"",f3name:void 0!==e?e.Field3Name:"",f4code:void 0!==e?e.Field4:"",f4desc:void 0!==e?e.Field4Desc:"",f4name:void 0!==e?e.Field4Name:"",f5code:void 0!==e?e.Field5:"",f5desc:void 0!==e?e.Field5Desc:"",f5name:void 0!==e?e.Field5Name:"",f6code:void 0!==e?e.Field6:"",f6desc:void 0!==e?e.Field6Desc:"",f6name:void 0!==e?e.Field6Name:"",f7code:void 0!==e?e.Field7:"",f7desc:void 0!==e?e.Field7Desc:"",f7name:void 0!==e?e.Field7Name:""}},w.checkInId=function(e){return"checkInLink"+e.LN},w.checkInSelectType=[{text:"Revert",value:"r",onClick:function(e){var t=$("#gridContainer").dxDataGrid("instance"),i=parseInt(w.wdSelecteFile.LN)-1;t.selectRowsByIndexes(i),function(e){$("#gridContainer").dxDataGrid("instance").getSelectedRowsData();w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],w.$parent.dialogTitle="Check-In",w.checkInput(e)}(w.wdSelecteFile)}},{text:"Overwrite",value:"o",onClick:function(e){var t=$("#checkin").dxFileUploader("instance");t._isCustomClickEvent=!0,t._$fileInput.click(),C.checkinType="R"}},{text:"New version",value:"v",onClick:function(e){var t=$("#checkin").dxFileUploader("instance");t._isCustomClickEvent=!0,t._$fileInput.click(),C.checkinType="N"}}],w.contextMenuTemplate=function(e){return{target:"#checkInLink"+e.LN,dataSource:w.checkInSelectType,elementAttr:{id:"checkInMenu"+e.LN}}},w.checkInFrom=function(e){$("#checkInMenu"+e.LN).dxContextMenu("toggle",!0),w.wdSelecteFile=e},w.setToolbarStatus=function(e){var t,i;if(void 0===e)t=!(i="#wdOpenFile, #wdChkOut, #wdEditProfile, #wdCopyProfile, #wdEmail, #wdViewFile");else switch(e.I){case"54":i="#wdChkOut, #wdEditProfile, #wdCopyProfile",t=!0;break;case"55":i="#wdOpenFile, #wdChkOut, #wdEditProfile, #wdCopyProfile, #wdEmail, #wdViewFile",t=!0;break;default:t=!(i="#wdOpenFile, #wdChkOut, #wdEditProfile, #wdCopyProfile, #wdEmail, #wdViewFile")}$(i).each(function(){$(this).dxButton("instance").option("disabled",t)})},w.checkOutput=function(o){return d.checkout(o).then(function(e){var t=e.data.fileStatus;if(""!=t.errorStatus.ErrorCount)return w.errorType(t,!0,o),!1;var i={title:o.DocId,desc:o.Description,wdMsg:"File Checked out Succesfully"};w.$parent.fileSuccessMessage.push(i),C.wdStatus=Math.round(new Date/1e3),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0,w.dwnload(o,!0)}),!0},w.errorType=function(e,t,i){var o;if(""!==e.errorStatus.wd_Error_DOCID)return o={title:i.DocId,desc:i.Description,wdMsg:e.errorStatus.wd_Error_MSG},w.$parent.fileErrorMessage.push(o),w.$parent.genericError=!1,w.$parent.errorTypeDialog="action",!(w.$parent.fileError=!0);o={wdMsg:e.errorStatus.wd_Error_MSG},w.$parent.fileErrorMessage.push(o),w.$parent.genericError=!0,w.$parent.errorTypeDialog="action",w.$parent.fileError=!0},w.checkInput=function(o){return d.checkIn(o).then(function(e){var t=e.data.fileStatus;if(""!=t.errorStatus.ErrorCount)return w.errorType(t,!0,o),!1;var i={title:o.DocId,desc:o.Description,wdMsg:"File Checked in Succesfully"};w.$parent.fileSuccessMessage.push(i),o.I="0",w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}),!0},w.currentDeleteFiles={},w.visibleDeletePopup=!1,w.width_popupDel=550,$(window).width()<768&&(w.width_popupDel="80%"),w.popupOptions={width:w.width_popupDel,height:"auto",contentTemplate:"delete",showTitle:!0,title:"Delete",dragEnabled:!1,closeOnBackButton:!1,closeOnOutsideClick:!1,showCloseButton:!1,bindingOptions:{visible:"visibleDeletePopup"}},w.showDeletePopup=function(e){w.currentDeleteFiles=e,w.visibleDeletePopup=!0},C.$on("openDeletePopup",function(e,t){w.currentDeleteFiles=t,w.visibleDeletePopup=!0}),w.validateGroup={validationRules:[{type:"required",message:"Please select a Delete method"}]},w.applyDeleteButtonOptions={text:"Ok",type:"success",width:90,useSubmitBehavior:!0},w.deleteData=function(){w.visibleDeletePopup=!1,angular.forEach(w.currentDeleteFiles,function(i,e){d.deleteFile(i,w.deleteValue).then(function(e){var t=e.data;if(w.$parent.fileErrorMessage=[],w.$parent.fileSuccessMessage=[],""!==t.fileStatus.errorStatus.ErrorCount)return w.$parent.dialogTitle="Delete",w.errorType(t.fileStatus,!0,i),!1;$("#gridContainer").dxDataGrid("instance").refresh()})})},w.cancelDeleteButtonOptions={text:"Cancel",type:"danger",width:90,onClick:function(e){w.visibleDeletePopup=!1}},w.dwnload=function(n,a){w.dwnloadSpinner=!1;var l={RN:n.RN,LID:n.LID,LN:n.LN,PGID:n.profileGroupId,Field1:n.Field1,Field2:n.Field2,Field3:n.Field3,Field4:n.Field4,Field5:n.Field5,Field6:n.Field6,Field7:n.Field7};d.download(l).then(function(o){w.$parent.fileErrorMessage=[];var e=o.data.download;if(""!==e.errorStatus.ErrorCount){var t={title:l.DocId,desc:l.Description,wdMsg:e.errorStatus.wd_Error_MSG};w.dwnloadSpinner=!0,w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(e.message){t={title:l.DocId,desc:l.Description,wdMsg:e.errorStatus.wd_Error_MSG};w.dwnloadSpinner=!0,w.$parent.fileErrorMessage.push(t),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}else if(-1!=v.indexOf("Frowser"))d.getFolderLevel().then(function(e){for(var t=0;t<e.data.root.Cabinets.length;t++)if(e.data.root.Cabinets[t].pgID==l.PGID){var i=e.data.root.Cabinets[t].pgFields.split("|");return w.checkedOut(l,o.data,i),!1}},function(e){w.dwnloadSpinner=!0,$log.error(e),DevExpress.ui.notify("IIS error 500","error",4e3)});else{if(w.dwnloadSpinner=!0,1!=a){w.$parent.fileSuccessMessage=[];var i={title:l.DocId,desc:l.Description,wdMsg:"File downloaded Succesfully"};w.$parent.fileSuccessMessage.push(i),w.$parent.errorTypeDialog="action",w.$parent.fileError=!0}w.dwnloadSpinner=!0,r.location.href=g.host+o.data.download.fileLoc,w.updateList(n)}},function(e){$log.error(e)})},w.isPopupVisible=!1,w.popupCustomizeOptions={width:210,height:120,contentTemplate:"info",showTitle:!1,dragEnabled:!1,closeOnOutsideClick:function(){w.isPopupVisible=!w.isPopupVisible},position:{my:"left",at:"bottom",of:"#btnCustomize"},bindingOptions:{visible:"isPopupVisible"}},w.cancelCustomizeListView=function(){w.isPopupVisible=!1},w.applyCustomerListView=function(){w.isPopupVisible=!1,w.saveFavView()},w.isPopupVisibleColumnChooser=!1,w.popupColumnChooserOptions={width:250,height:320,contentTemplate:"info",title:"Column Chooser",dragEnabled:!0,closeOnOutsideClick:!1,closeOnBackButton:!1,showCloseButton:!0,position:{my:"left",at:"bottom",of:C.parentColumnChoose},bindingOptions:{visible:"isPopupVisibleColumnChooser"}},w.setComments=function(e){return"<i class='ms-Icon ms-Icon--Comment listComments' aria-hidden='true'></i><span pg-clamp='2' class='commentTxt'>"+e+"</span>"},w.deleteList=[{text:"Move to Salvage Bin",value:parseInt(16384)+parseInt(72)},{text:"Delete",value:16384},{text:"Shred (unrecoverable)",value:65536}],w.delGroup={items:w.deleteList,itemTemplate:function(e,t,i){i.parent().text(e.text)},onValueChanged:function(e){w.deleteValue=e.value.value}},w.applyColumnChooserPopUp=function(){w.isPopupVisibleColumnChooser=!1,w.isPopupVisible=!1;var e=$("#hdd-selecteditem").val().split(", "),t=$("#gridContainer").dxDataGrid("instance");t.beginUpdate();for(var i=0;i<w.columnarr.length;i++){for(var o=w.columnarr[i],n=0,a=0;a<e.length;a++)o[0]==e[a]&&(n=1);1==n?t.columnOption(o[1],"visible",!0):t.columnOption(o[1],"visible",!1)}t.endUpdate(),-1!=e.indexOf("Ver #")?w.showVersion=!1:w.markVersion&&(w.showVersion=!0),-1!=e.indexOf("Modified")?w.showModified=!1:w.markModified&&(w.showModified=!0),-1!=e.indexOf("Size")?w.showSize=!1:w.markSize&&(w.showSize=!0),-1!=e.indexOf("Created")?w.showCreated=!1:w.markCreated&&(w.showCreated=!0),-1!=e.indexOf("Accessed")?w.showAccessed=!1:w.markAccessed&&(w.showAccessed=!0),-1!=e.indexOf("Doc ID")?w.showDocID=!1:w.markDocId&&(w.showDocID=!0),g.MarkFavView&&w.saveFavView()},w.saveFavView=function(){for(var t=$("#gridContainer").dxDataGrid("instance"),e=t.getVisibleColumns().filter(function(e){return e.showInColumnChooser}).map(function(e){return e.caption}),i=t.getVisibleColumns().filter(function(e){return e.showInColumnChooser}).map(function(e){return t.columnOption(e.caption,"width")}),o=[],n=$("#gridContainer").dxDataGrid("instance"),a=0;a<n.columnCount();a++){var l=n.columnOption(a);o.push(l.visibleIndex)}g.ColumnsIndex=o,g.MarkFavView=!0,g.ColumnsChooser=e,g.DescriptionWidth=t.columnOption("Description","width"),g.ColumnsWidths=i,localStorage.setItem("ngStorage-ColumnsWidths",JSON.stringify(i)),-1!=e.indexOf("Comments")?w.showComments=!1:w.showComments=!0,-1!=e.indexOf("Ver #")?w.showVersion=!1:w.markVersion&&(w.showVersion=!0),-1!=e.indexOf("Modified")?w.showModified=!1:w.markModified&&(w.showModified=!0),-1!=e.indexOf("Size")?w.showSize=!1:w.markSize&&(w.showSize=!0),-1!=e.indexOf("Created")?w.showCreated=!1:w.markCreated&&(w.showCreated=!0),-1!=e.indexOf("Accessed")?w.showAccessed=!1:w.markAccessed&&(w.showAccessed=!0),-1!=e.indexOf("Doc ID")?w.showDocID=!1:w.markDocId&&(w.showDocID=!0)},w.hoverDescription=function(e){var t=e.currentTarget.parentElement;if(t.scrollWidth>t.clientWidth){var i=e.currentTarget.innerHTML;w.ttl_dsc=i}else w.ttl_dsc=" "},C.setTitleHeaderWidth=function(){$("#listTitle").css({"max-width":"0px",width:"0px"});var e=$("#gridContainer .dx-datagrid-header-panel").width(),t=$("#gridContainer .dx-datagrid-header-panel .dx-toolbar-after").width(),i=parseInt(e)-parseInt(t)-50;setTimeout(function(){$("#listTitle").css({"max-width":i+"px",width:i+"0px"})},100)}}angular.module("WDWeb"),dataGridController.$inject=["$scope","$http","$localStorage","$location","$q","$window","fileListUI","uxService","wdService","uploader","homeService","$rootScope","$timeout"],angular.module("WDWeb").controller("dataGridController",dataGridController);
>>>>>>> f87e3847757683542f66b38ce05de0356ce87e8f
