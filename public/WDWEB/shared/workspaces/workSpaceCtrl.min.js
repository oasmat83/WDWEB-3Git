angular.module("WDWeb").controller("workSpaceCtrl",["$scope","$rootScope","$route","$routeParams","$timeout","$log","$window","$localStorage","$location","wdService","homeService","leftNavService",function(e,o,r,t,n,i,s,a,l,c,u,d){var w=this;w.message="",w.thisToggle=!0;$(window).keydown(function(e){(e.ctrlKey||e.metaKey)&&70===e.keyCode&&e.preventDefault()}),e.$on("closeAllPanel",function(e,r){w.showWksPanel=!1}),e.$on("workSpacePanel",function(e,r){w.showWksPanel&&o.$broadcast("workspaceEvent",r)}),e.$on("workspaceEvent",function(e,r){if(w.showWksPanel=r.show,w.workSpaceTitle=r.data.Text,w.spinner=!1,w.wdListId=r.listId,0==r.data.Flags)return w.spinner=!0,w.message="No folders found!",!(w.workSpaces=[]);var o;d.getChild(r.listId,r.data["Rec#"],(o=r.data.Flags,1==o?3:5)).then(function(e){var r=e.data.root;if(""!=r.Header.ErrorCount)return DevExpress.ui.notify(r.Header.wd_Error_MSG,"error",4e3),!(w.spinner=!0);angular.forEach(r.items,function(e,r){w.message="",e.nodes=[[{dummy:"node"}]]}),w.spinner=!0,w.workSpaces=r.items,w.message=""},function(e){DevExpress.ui.notify("Error 500","error",4e3)})}),w.setSelectMenu=function(e){w.setFmSelect=e},w.getChild=function(o,e,r){var t;if(0==(w.setFmSelect=o).Flags)return!1;e.thisToggle=e.thisToggle=!e.thisToggle,t=e.thisToggle?3:5,d.getChild(w.wdListId,o["Rec#"],t).then(function(e){var r=e.data.root;if(""!=r.Header.ErrorCount)return DevExpress.ui.notify(r.Header.wd_Error_MSG,"error",4e3),!1;o.nodes=r.items},function(e){DevExpress.ui.notify("500 Server Error","error",4e3)}),e.$parent.toggle()},w.closeCabinet=function(){w.showWksPanel=!1},e.scrollWk={scrollByContent:!0,scrollByThumb:!0,showScrollbar:"always",useNative:!0,height:function(){return window.innerHeight-150}},e.setHeight=function(){return window.innerHeight-150},w.showFiles=function(e){l.path("/home").search({listId:a.wdWorkSpaceID,recId:e["Rec#"],flagId:0,typeid:"workspaces"}),w.closeCabinet()}}]).directive("workMenu",function(t,e){return{templateUrl:"./WDWEB/shared/workspaces/workMenu.html",link:function(e,r,o){t.on("click",function(e){r!==e.target&&r[0].contains(e.target)})}}});